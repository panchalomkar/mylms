{"version":3,"file":"versionmanager.min.js","sources":["../src/versionmanager.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Change the iframe size relative to the window size.\n *\n * @module     mod_collabora/resizeiframe\n * @author     Andreas Grabs <moodle@grabs-edv.de>\n * @copyright  2019 Humboldt-Universit√§t zu Berlin <moodle-support@cms.hu-berlin.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport log from 'core/log';\n\nexport const init = (id) => {\n    const table = document.querySelector(\"#version_viewer_table-\" + id);\n    table.addEventListener(\"click\", (event) => {\n        const target = event.target;\n        const version = target.dataset.version;\n        if (target.classList.contains(\"collabora-preview-button\")) {\n            event.preventDefault();\n            event.stopPropagation();\n            postMessage({\n                'MessageId': 'SET_VERSION',\n                'Values': {\n                    'version': version\n                }\n            });\n        }\n        if (target.classList.contains(\"collabora-restore-button\")) {\n            event.preventDefault();\n            event.stopPropagation();\n            postMessage({\n                'MessageId': 'RESTORE_VERSION',\n                'Values': {\n                    'version': version\n                }\n            });\n        }\n        if (target.classList.contains(\"collabora-deleteversion-button\")) {\n            event.preventDefault();\n            event.stopPropagation();\n            postMessage({\n                'MessageId': 'DELETE_VERSION',\n                'Values': {\n                    'version': version\n                }\n            });\n        }\n    });\n\n    /**\n     * Send a message to the collabora editor\n     * @param {object} postObject The object we want to post.\n     */\n    function postMessage(postObject) {\n        postObject.SendTime = Date.now();\n        var message = JSON.stringify(postObject);\n        log.debug('Post message to myself: ' + message);\n\n        window.postMessage(message, '*');\n    }\n\n};\n"],"names":["id","postMessage","postObject","SendTime","Date","now","message","JSON","stringify","debug","window","document","querySelector","addEventListener","event","target","version","dataset","classList","contains","preventDefault","stopPropagation"],"mappings":";;;;;;;;kJA0BqBA,cAyCRC,YAAYC,YACjBA,WAAWC,SAAWC,KAAKC,UACvBC,QAAUC,KAAKC,UAAUN,yBACzBO,MAAM,2BAA6BH,SAEvCI,OAAOT,YAAYK,QAAS,KA7ClBK,SAASC,cAAc,yBAA2BZ,IAC1Da,iBAAiB,SAAUC,cACvBC,OAASD,MAAMC,OACfC,QAAUD,OAAOE,QAAQD,QAC3BD,OAAOG,UAAUC,SAAS,8BAC1BL,MAAMM,iBACNN,MAAMO,kBACNpB,YAAY,WACK,qBACH,SACKe,YAInBD,OAAOG,UAAUC,SAAS,8BAC1BL,MAAMM,iBACNN,MAAMO,kBACNpB,YAAY,WACK,yBACH,SACKe,YAInBD,OAAOG,UAAUC,SAAS,oCAC1BL,MAAMM,iBACNN,MAAMO,kBACNpB,YAAY,WACK,wBACH,SACKe"}