"use strict";define(["jquery"],function(i){i(document).ready(function(){function e(e,t){var a=["primary","warning","success","info"],n=document.createElement("span");i(n).html(t),i(n).attr("data-email",t),i(n).attr("class","email-tag btn btn-"+a[Math.floor(Math.random()*a.length)]);var l=document.createElement("span");i(l).attr("class","email-tag-delete"),i(l).html("X"),i(n).append(i(l)),i(n).insertBefore(i(".notifi-email-group").children()[e])}function t(t){if(-1!=s){var a=i(t).data("index");switch(function(i,e){return/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/.test(e)?-1!=l.indexOf(e)&&l.indexOf(e)!=i?2:1:0}(a,i(t).val())){case 0:return void o(M.util.get_string("efb-lbl-notifi-email-warning","local_edwiserform"));case 1:s=-1;var n=i(t).val();return i(t).remove(),e(a,n),l[a]=n,i("#id_notifi_email").val(l.join(",")),void r();case 2:return void o(M.util.get_string("efb-lbl-notifi-email-duplicate","local_edwiserform"))}}}function a(e){var t="<div class='efb-email-tags show'><ul>";return i.each(e,function(i,e){var a=M.util.get_string(e,"local_edwiserform");t+='<li><a href="#" class="efb-email-tag" title="'+a+'">'+i+"</a></li>"}),t+="</ul></div>"}i("#id_notifi_email").parent().prepend('<div class="notifi-email-group"><input type="email" class="notifi-email-group-input form-control" id="notifi-email-group-input"/><div>'+M.util.get_string("efb-recipient-email-desc","local_edwiserform")+"</div></div>"),i("#id_notifi_email").hide(),i("#id_notifi_email_body").after(M.util.get_string("efb-restore-desc","local_edwiserform",{id:"#id_notifi_email_bodyeditable",string:"efb-notify-email-body"})),i("#id_confirmation_msg").after(M.util.get_string("efb-restore-desc","local_edwiserform",{id:"#id_confirmation_msgeditable",string:"efb-confirmation-default-msg"})),i("#id_success_message").after(M.util.get_string("submission-successful-desc","local_edwiserform",{id:"#id_success_messageeditable",string:"submission-successful"})),i(".efb-restore").click(function(){i(i(this).data("id")).html(M.util.get_string(i(this).data("string"),"local_edwiserform"))}),i("body").on("click",".efb-email-show-tags>a",function(){i(this).next().toggleClass("show"),i(this).text(i(this).next().hasClass("show")?M.util.get_string("efb-email-hide-tags","local_edwiserform"):M.util.get_string("efb-email-show-tags","local_edwiserform"))});var n={"{SITE_NAME}":"site-name","{USER_FULLNAME}":"user-fullname","{USER_FIRSTNAME}":"user-firstname","{USER_LASTNAME}":"user-lastname","{AUTHOR_NAME}":"author-name","{AUTHOR_FIRSTNAME}":"author-firstname","{AUTHOR_LASTNAME}":"author-lastname","{FORM_TITLE}":"form-title","{USER_LINK}":"user-link","{ALL_FIELDS}":"all-fields",'{VIEW_DATA_LINK LABEL="click"}':"view-data-link"};i("#id_notifi_email_body").parents(".felement").siblings().append('<div class="efb-email-show-tags"><a href="#">'+M.util.get_string("efb-email-hide-tags","local_edwiserform")+"</a>"+a(n)+"</div>"),i("#id_confirmation_msg").parents(".felement").siblings().append('<div class="efb-email-show-tags"><a href="#">'+M.util.get_string("efb-email-hide-tags","local_edwiserform")+"</a>"+a(n)+"</div>"),i("#id_success_message").parents(".felement").siblings().append('<div class="efb-email-show-tags"><a href="#">'+M.util.get_string("efb-email-hide-tags","local_edwiserform")+"</a>"+a({"{HOMEPAGE}":"homepage","{DASHBOARD}":"dashboard",'{VIEW_DATA_LINK LABEL="click"}':"view-data-link"})+"</div>");var l=i("#id_notifi_email").val().trim(),s=-1;function o(e){i("#id_error_notifi_email").html(e),i("#id_error_notifi_email").show(),i("#id_error_notifi_email").parent(".felement").addClass("has-danger")}function r(){i("#id_error_notifi_email").hide().parent(".felement").removeClass("has-danger"),i("#id_notifi_email").val(l.join(","))}function d(t){if(""!=i(t).val())switch(function(i){return/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/.test(i)?-1!=l.indexOf(i)?2:1:0}(i(t).val())){case 0:return void o(M.util.get_string("efb-lbl-notifi-email-warning","local_edwiserform"));case 1:var a=i(t).siblings(".email-tag").length,n=i(t).val().trim();return e(a,n),l.push(n),i(t).val(""),void r();case 2:return void o(M.util.get_string("efb-lbl-notifi-email-duplicate","local_edwiserform"))}else r()}l=l.length>0?l.split(","):[],i.each(l,function(i,t){e(i,t)}),i("body").on("click",".email-tag-delete",function(){var e=i(this).parent(),t=i(".email-tag").index(e);l.splice(t,1),e.remove(),i("#id_notifi_email").val(l.join(","))}),i("body").on("dblclick",".email-tag",function(){!function(e){var t=i(e).data("email"),a=i(".email-tag").index(e);s=a;var n=document.createElement("input");i(e).remove(),i(n).val(t),i(n).attr("class","notifi-email-group-edit"),i(n).attr("data-index",a),i(n).insertBefore(i(".notifi-email-group").children()[a]),i(n).focus()}(i(this))}),i("body").on("focusout",".notifi-email-group-edit",function(){t(i(this))}),i("body").on("keyup",".notifi-email-group-edit",function(e){13!=e.keyCode&&27!=e.keyCode||t(i(this))}),i("body").on("keyup","#notifi-email-group-input",function(e){13==e.keyCode||32==e.keyCode?d(this):188==e.keyCode&&(i(this).val(i(this).val().slice(0,-1)),d(this))}),i("body").on("focusout","#notifi-email-group-input",function(i){i.preventDefault(),d(this)})})});
//# sourceMappingURL=efb_form_basic_settings.min.js.map
