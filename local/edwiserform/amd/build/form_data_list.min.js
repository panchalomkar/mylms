"use strict";define(["jquery","core/ajax","core/notification","core/templates","local_edwiserform/jquery.dataTables","local_edwiserform/dataTables.bootstrap4","local_edwiserform/buttons.bootstrap4","local_edwiserform/fixedColumns.bootstrap4","local_edwiserform/formviewer"],function(e,t,o,i){var s=function(){0!=e(".efb-form-submissions-table tr").length&&e(".efb-form-submissions-table tr").each(function(t,o){e(o).find(".efb-data-actions span").remove();var i=e(o).find(".efb-data-action.show");i.length<2||i.slice(0,i.length-1).after("<span> | </span>")})},r=function(t){for(var o=e("<ul></ul>"),i=0;i<t.length;i++)o.append(e("<li>"+t[i]+"</li>"));Formeo.dom.alert("warning",o.get(0))};return{updateSeparator:s,init:function(a,l){var n,c={DELETE_SUBMISSION:function(e){return t.call([{methodname:"edwiserform_delete_submissions",args:{id:a,submissions:e}}])[0]},GET_FORM_SUBMISSIONS:function(e,o,i,s){return t.call([{methodname:"edwiserform_get_form_submissions",args:{formid:a,search:e,start:o,length:i,sort:s}}])[0]}};function d(t){Formeo.dom.multiActions("warning",M.util.get_string("deletesubmission","local_edwiserform"),M.util.get_string("deletesubmissionmsg","local_edwiserform"),[{title:M.util.get_string("proceed","local_edwiserform"),type:"danger",action:function(){Formeo.dom.loading(),c.DELETE_SUBMISSION(t).done(function(t){1==t.status&&(Formeo.dom.alert("success",'<div class="col-12">'+t.msg+"</div>"),n.draw(),e(".submission-check-all").prop("checked",!1)),Formeo.dom.loadingClose()}).fail(function(e){o.exception(e),Formeo.dom.loadingClose()})}},{title:M.util.get_string("cancel","local_edwiserform"),type:"success"}])}e.fn.dataTable.ext.errMode="none",e(document).ready(function(){l||e("body").addClass("user-view"),n=e("#efb-form-submissions").DataTable({paging:!0,bProcessing:!0,bServerSide:!0,rowId:"DT_RowId",bDeferRender:!0,scrollY:"400px",scrollX:!0,scrollCollapse:!0,autoWidth:!0,classes:{sScrollHeadInner:"efb_dataTables_scrollHeadInner"},order:[[2,"asc"]],columnDefs:[{orderable:!1,targets:"sorting_disabled"},{orderable:!0,targets:"sorting",orderSequence:["desc","asc"]}],dom:'<"efb-top"<"efb-listing"l><"efb-list-filtering"f>>t<"efb-bottom"<"efb-list-pagination"p><B>'+(l?'<"efb-bulk">':"")+">i",language:{sSearch:M.util.get_string("search-entry","local_edwiserform"),emptyTable:M.util.get_string("listformdata-empty","local_edwiserform"),info:M.util.get_string("efb-heading-listforms-showing","local_edwiserform",{start:"_START_",end:"_END_",total:"_TOTAL_"}),infoEmpty:M.util.get_string("efb-heading-listforms-showing","local_edwiserform",{start:"0",end:"0",total:"0"}),paginate:{first:M.util.get_string("first","local_edwiserform"),last:M.util.get_string("last","local_edwiserform"),next:M.util.get_string("next","local_edwiserform"),previous:M.util.get_string("previous","local_edwiserform")},lengthMenu:M.util.get_string("show-entries","local_edwiserform",{menu:"_MENU_"})},buttons:[],ajax:function(e,t,i){c.GET_FORM_SUBMISSIONS(e.search.value,e.start,e.length,e.order[0].dir).done(function(e){0!=e.errors.length&&r(e.errors),delete e.errors,t(e),s()}).fail(o.exception)},drawCallback:function(t){s(),l&&(e(".efb-bottom .dt-buttons").removeClass("btn-group"),i.render("local_edwiserform/bulk-actions",{formid:a,wwwroot:M.cfg.wwwroot,license:"available"==license?"":M.util.get_string("activate-license","local_edwiserform")},"theme_remui").done(function(t,o){i.replaceNode(e(".efb-bulk"),t,o)}).fail(o.exception))}}),e("body").on("click",".data-toggler",function(){var t=e(this).closest(".efb-table-data-expand");t.is(".expanded")?(t.removeClass("expanded"),t.find(".table-data").html(t.data("short")),e(this).text(M.util.get_string("readmore","local_edwiserform"))):(t.addClass("expanded"),t.find(".table-data").html(t.data("long")),e(this).text(M.util.get_string("readless","local_edwiserform"))),n.columns.adjust()})}),e("body").on("click",".efb-csv-export",function(){"available"==license?window.open(M.cfg.wwwroot+"/local/edwiserform/export.php?id="+a+"&action=data"):window.location.href=M.cfg.wwwroot+"/admin/settings.php?section=local_edwiserform&activetab=local_edwiserform_license_status"}),e("body").on("change",".submission-check-all",function(){e(".submission-check").prop("checked",e(this).is(":checked"))}),e("body").on("click","#efb-apply-actions",function(){switch(e("#efb-bulk-actions").val()){case"bulkaction":Formeo.dom.toaster(M.util.get_string("selectbulkaction","local_edwiserform"));break;case"delete":if(!e(".submission-check").is(":checked"))return void Formeo.dom.toaster(M.util.get_string("emptysubmission","local_edwiserform"));var t=[];e(".submission-check:checked").each(function(o,i){t.push(e(i).data("value"))}),d(t)}}),e("body").on("click",".efb-data-action.delete-action",function(){d([e(this).data("value")])}),e("body").on("click",".efb-data-action",function(e){e.preventDefault()})}}});
//# sourceMappingURL=form_data_list.min.js.map
