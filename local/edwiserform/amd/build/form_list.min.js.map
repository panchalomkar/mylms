{"version":3,"sources":["form_list.js"],"names":["define","$","Ajax","Notification","init","table","PROMISES","search","start","length","order","call","methodname","args","document","ready","DataTable","paging","ordering","bProcessing","bServerSide","rowId","bDeferRender","scrollY","scrollX","scrollCollapse","fixedColumns","leftColumns","rightColumns","classes","sScrollHeadInner","dom","columns","data","orderable","class","ajax","callback","settings","value","done","response","fail","exception","language","sSearch","M","util","get_string","emptyTable","info","end","total","infoEmpty","paginate","first","last","next","previous","lengthMenu","menu","fnRowCallback","nRow","aData","iDisplayIndex","iDisplayIndexFull","addClass","attr","drawCallback","html","click","removeClass","on","event","preventDefault","id","this","row","parents","title","children","text","license","window","location","href","cfg","wwwroot","status","draw","input","formid","action","is","prop","parent","enableDisableForm","prev","temp","append","shortcode","val","select","execCommand","remove","Formeo","toaster"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Edwiser Form form_list js\n * @package   local_edwiserform\n * @copyright (c) 2020 WisdmLabs (https://wisdmlabs.com/) <support@wisdmlabs.com>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author    Yogesh Shirsath\n */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'local_edwiserform/jquery.dataTables',\n    'local_edwiserform/dataTables.bootstrap4',\n    'local_edwiserform/buttons.bootstrap4',\n    'local_edwiserform/fixedColumns.bootstrap4',\n    'local_edwiserform/formviewer'\n], function($, Ajax, Notification) {\n    return {\n        init: function() {\n\n            var table;\n\n            var PROMISES = {\n\n                /**\n                 * Get forms using ajax\n                 * @param  {String}  search Search query\n                 * @param  {Number}  start  Start index of courses\n                 * @param  {Number}  length Number of courses\n                 * @param  {Array}   order  Column order\n                 * @return {Promise}        Ajax promise\n                 */\n                GET_FORMS: function(search, start, length, order) {\n                    return Ajax.call([{\n                        methodname: 'edwiserform_get_forms',\n                        args: {\n                            search: search,\n                            start: start,\n                            length: length,\n                            order: order\n                        }\n                    }])[0];\n                },\n            };\n            $(document).ready(function() {\n                table = $(\"#efb-forms\").DataTable({\n                    paging: true,\n                    ordering: true,\n                    bProcessing: true,\n                    bServerSide: true,\n                    rowId: 'DT_RowId',\n                    bDeferRender: true,\n                    scrollY: \"400px\",\n                    scrollX: true,\n                    scrollCollapse: true,\n                    fixedColumns: {\n                        leftColumns: 1,\n                        rightColumns: 1\n                    },\n                    classes: {\n                        sScrollHeadInner: 'efb_dataTables_scrollHeadInner'\n                    },\n                    dom: '<\"efb-top\"<\"efb-listing\"l><\"efb-list-filtering\"f>>t<\"efb-bottom\"<\"efb-form-list-info\"i>' +\n                        '<\"efb-list-pagination\"p>><\"efb-shortcode-copy-note\">',\n                    columns: [\n                        { data: \"title\" },\n                        { data: \"type\" },\n                        { data: \"shortcode\", \"orderable\": false },\n                        { data: \"author\" },\n                        { data: \"created\" },\n                        { data: \"author2\" },\n                        { data: \"modified\" },\n                        { data: \"allowsubmissionsfromdate\" },\n                        { data: \"allowsubmissionstodate\" },\n                        { data: \"actions\", \"orderable\": false, 'class': 'text-center' }\n                    ],\n                    // eslint-disable-next-line no-unused-vars\n                    ajax: function(data, callback, settings) {\n                        PROMISES.GET_FORMS(\n                            data.search.value,\n                            data.start,\n                            data.length,\n                            data.order[0]\n                        ).done(function(response) {\n                            callback(response);\n                        }).fail(Notification.exception);\n                    },\n                    language: {\n                        sSearch: M.util.get_string('efb-search-form', 'local_edwiserform'),\n                        emptyTable: M.util.get_string('listforms-empty', 'local_edwiserform'),\n                        info: M.util.get_string(\n                            'efb-heading-listforms-showing',\n                            'local_edwiserform', { 'start': '_START_', 'end': '_END_', 'total': '_TOTAL_' }\n                        ),\n                        infoEmpty: M.util.get_string(\n                            'efb-heading-listforms-showing',\n                            'local_edwiserform', { 'start': '0', 'end': '0', 'total': '0' }\n                        ),\n                        paginate: {\n                            first: M.util.get_string('first', 'local_edwiserform'),\n                            last: M.util.get_string('last', 'local_edwiserform'),\n                            next: M.util.get_string('next', 'local_edwiserform'),\n                            previous: M.util.get_string('previous', 'local_edwiserform')\n                        },\n                        lengthMenu: M.util.get_string('show-entries', 'local_edwiserform', { 'menu': '_MENU_' }),\n                    },\n                    // eslint-disable-next-line no-unused-vars\n                    \"fnRowCallback\": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n                        $('td:eq(0)', nRow).addClass(\"efb-tbl-col-title\");\n                        $('td:eq(2)', nRow).addClass(\"efb-tbl-col-shortcode\").attr(\n                            'title',\n                            M.util.get_string('clickonshortcode', 'local_edwiserform')\n                        );\n                        $('td:eq(9)', nRow).addClass(\"text-center\");\n                    },\n                    // eslint-disable-next-line no-unused-vars\n                    drawCallback: function(settings) {\n                        $('.efb-shortcode-copy-note').html(M.util.get_string('note', 'local_edwiserform') + ' ' +\n                            M.util.get_string('clickonshortcode', 'local_edwiserform'));\n                    }\n                });\n                $('.efb-modal-close').click(function() {\n                    $('#efb-modal').removeClass('show');\n                });\n                $('body').on('click', '.efb-form-delete', function(event) {\n                    event.preventDefault();\n                    var id = $(this).data('formid');\n                    var row = $(this).parents('tr');\n                    var title = $(row).children('.efb-tbl-col-title').text();\n                    $('#efb-modal .efb-modal-header').removeClass('bg-success').addClass('bg-warning')\n                        .children('.efb-modal-title').html(M.util.get_string('warning', 'local_edwiserform'));\n                    $('#efb-modal .efb-modal-body').html('<h5>' + M.util.get_string(\n                        'efb-delete-form-and-data',\n                        'local_edwiserform', {\n                            title: title,\n                            id: id\n                        }\n                    ) + '</h5>');\n                    $('#efb-modal').addClass('show delete').removeClass('pro');\n                    $('#efb-modal .efb-modal-delete-form').data('formid', id);\n                    return;\n                }).on('click', '.efb-form-export', function(event) {\n                    // eslint-disable-next-line no-undef\n                    if (license != 'available') {\n                        $('#efb-modal .efb-modal-header').removeClass('bg-success').addClass('bg-warning');\n                        $('#efb-modal .efb-modal-title').html(M.util.get_string('hey-wait', 'local_edwiserform'));\n                        $('#efb-modal .efb-modal-body').html('<h5>' + M.util.get_string(\n                            'efb-template-inactive-license',\n                            'local_edwiserform',\n                            M.util.get_string('efb-form-action-export-title', 'local_edwiserform')\n                        ) + '</h5>');\n                        $('#efb-modal').addClass('show pro').removeClass('delete');\n                        event.preventDefault();\n                        return;\n                    }\n                }).on('click', '.efb-modal-pro-activate', function() {\n                    window.location.href = M.cfg.wwwroot +\n                        '/admin/settings.php?section=local_edwiserform&activetab=local_edwiserform_license_status';\n                });\n                $('body').on('click', '.efb-modal-delete-form', function(event) {\n                    event.preventDefault();\n                    var id = $(this).data('formid');\n                    var reqDeleteForm = Ajax.call([{\n                        methodname: 'edwiserform_delete_form',\n                        args: {\n                            id: id\n                        }\n                    }]);\n                    reqDeleteForm[0].done(function(response) {\n                        if (response.status == true) {\n                            table.draw();\n                        }\n                    }).fail(Notification.exception);\n                    $('.efb-modal-close').click();\n                });\n\n                /**\n                 * Enable or disable form on the basis on form id\n                 * @param  {DOM} input DOM element\n                 */\n                function enableDisableForm(input) {\n                    var formid = $(input).data('formid');\n                    var enabledisableform = Ajax.call([{\n                        methodname: 'edwiserform_enable_disable_form',\n                        args: {\n                            id: formid,\n                            action: !$(input).is(':checked')\n                        }\n                    }]);\n                    enabledisableform[0].done(function(response) {\n                        if (response.status) {\n                            $(input).prop('checked', $(input).is(':checked'));\n                        } else {\n                            $(input).prop('checked', !$(input).is(':checked'));\n                        }\n                        $(input).parent().attr('title', $(input).is(':checked') ? $(input).data('disable-title') :\n                            $(input).data('enable-title'));\n                    }).fail(Notification.exception);\n                }\n\n                $('body').on('click', '.efb-enable-disable-form', function() {\n                    var input = $(this).prev();\n                    enableDisableForm(input);\n                });\n\n                $('body').on(\"click\", \".efb-tbl-col-shortcode\", function() {\n                    var temp = $('<input>');\n                    $('body').append(temp);\n                    var shortcode = $(this).text();\n                    temp.val(shortcode).select();\n                    document.execCommand('copy');\n                    temp.remove();\n                    // eslint-disable-next-line no-undef\n                    Formeo.dom.toaster(M.util.get_string('shortcodecopied', 'local_edwiserform', shortcode));\n                });\n            });\n        }\n    };\n});\n"],"file":"form_list.min.js"}
