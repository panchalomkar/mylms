define("local_edwiserpagebuilder/remuiblck/notes",["jquery","core/ajax","core/str"],(function($,Ajax,Str){var SELECTORS_ADD_NOTE_BUTTON=".epb-add-notes-button",SELECTORS_ADD_NOTE_SELECT=".epb-add-notes-select",SELECTORS_SITE_NOTE=".epb-site-note",SELECTORS_COURSE_NOTE=".epb-course-note",SELECTORS_PERSONAL_NOTE=".epb-personal-note",SELECTORS_STUDENT_LABEL=".epb-select2-studentlist-label",SELECTORS_STUDENT_LIST=".epb-select2-studentlist",SELECTORS_SELECT_STUDENT_NOTE=".epb-select-note-student",SELECTORS_ADD_NOTES_BUTTON_WRAPPER=".epb-add-notes-button-wrapper";const strings=[{key:"selectastudent",component:"local_edwiserpagebuilder"},{key:"nousersenrolledincourse",component:"local_edwiserpagebuilder"},{key:"total",component:"moodle"}];return{init:async function(root){await void Str.get_strings(strings).then((function(results){return results,results})),$(document).ready((function(){!function(root){var courseId,studentCount,userId,courseName;$(root+" "+SELECTORS_ADD_NOTE_SELECT).length&&($(root+" "+SELECTORS_ADD_NOTE_BUTTON).hide(),$(root+" "+SELECTORS_STUDENT_LABEL).hide(),$(root+" "+SELECTORS_STUDENT_LIST).hide(),$(root+" "+SELECTORS_ADD_NOTE_SELECT+" select").on("change",(function(){if($(root+" "+SELECTORS_ADD_NOTE_BUTTON).hide(),$(root+" "+SELECTORS_SELECT_STUDENT_NOTE).removeClass("d-none"),courseId=$(this).children(":selected").attr("id"),courseName=$(this).children(":selected").text(),void 0===courseId)return $(root+" "+SELECTORS_STUDENT_LABEL).hide(),$(root+" "+SELECTORS_STUDENT_LIST).empty(),void $(root+" "+SELECTORS_STUDENT_LIST).hide();Ajax.call([{methodname:"local_edwiserpagebuilder_remuiblck_action",args:{action:"get_enrolled_users_by_course",config:JSON.stringify({courseid:courseId})}}])[0].done((function(response){response=JSON.parse(response),studentCount=Object.keys(response).length,$(root+" "+SELECTORS_STUDENT_LABEL).show(),$(root+" "+SELECTORS_STUDENT_LIST).show(),$(root+" "+SELECTORS_STUDENT_LIST).empty(),studentCount?($(root+" "+SELECTORS_STUDENT_LIST).append("<option>"+M.util.get_string("selectastudent","local_edwiserpagebuilder")+" ("+M.util.get_string("total","moodle")+": "+studentCount+")</option>"),$.each(response,(function(index,student){$(root+" "+SELECTORS_STUDENT_LIST).append('<option value="'+student.id+'">'+student.fullname+"</option>")}))):$(root+" "+SELECTORS_STUDENT_LIST).append("<option>"+M.util.get_string("nousersenrolledincourse","local_edwiserpagebuilder",courseName)+"</option>")})).fail((function(ex){$(root+" "+SELECTORS_STUDENT_LIST).html("<option>"+ex.message+"</option>")}))})),$(root+" "+SELECTORS_STUDENT_LIST).on("change",(function(){$(root+" "+SELECTORS_ADD_NOTE_BUTTON).show(),$(root+" "+SELECTORS_ADD_NOTES_BUTTON_WRAPPER).removeClass("d-none"),userId=$(this).find("option:selected").val();var notesLink=M.cfg.wwwroot+"/notes/edit.php?courseid="+courseId+"&userid="+userId+"&publishstate=site";$(root+" "+SELECTORS_ADD_NOTE_BUTTON+" "+SELECTORS_SITE_NOTE).attr("href",notesLink),notesLink=M.cfg.wwwroot+"/notes/edit.php?courseid="+courseId+"&userid="+userId+"&publishstate=public",$(root+" "+SELECTORS_ADD_NOTE_BUTTON+" "+SELECTORS_COURSE_NOTE).attr("href",notesLink),notesLink=M.cfg.wwwroot+"/notes/edit.php?courseid="+courseId+"&userid="+userId+"&publishstate=draft",$(root+" "+SELECTORS_ADD_NOTE_BUTTON+" "+SELECTORS_PERSONAL_NOTE).attr("href",notesLink)})))}(root)}))}}}));

//# sourceMappingURL=notes.min.js.map