{"version":3,"file":"Plugin.min.js","sources":["../../src/remuiblck/Plugin.js"],"sourcesContent":["/* eslint-disable capitalized-comments */\n\"use strict\";\ndefine([\"exports\", \"jquery\"], function(exports, _jquery) {\n\n    Object.defineProperty(exports, \"__esModule\", {\n        value: true\n    });\n    exports.pluginFactory = exports.getDefaults = exports.getPlugin = exports.getPluginAPI = exports.Plugin = undefined;\n\n    var _jquery2 = _interopRequireDefault(_jquery);\n\n    /**\n     * @param {String} obj\n     */\n    function _interopRequireDefault(obj) {\n        return obj && obj.__esModule ? obj : {\n            \"default\": obj\n        };\n    }\n\n    let plugins = {};\n    let apis = {};\n\n    class Plugin {\n        constructor($el, options = {}) {\n            this.name = this.getName();\n            this.$el = $el;\n            this.options = options;\n            this.isRendered = false;\n        }\n\n        getName() {\n            return 'plugin';\n        }\n\n        render() {\n            if (_jquery2.default.fn[this.name]) {\n                this.$el[this.name](this.options);\n            } else {\n                return false;\n            }\n        }\n\n        initialize() {\n            if (this.isRendered) {\n                return false;\n            }\n\n            this.render();\n            this.isRendered = true;\n        }\n\n        static getDefaults() {\n            return {};\n        }\n\n        static register(name, obj) {\n            if (typeof obj === 'undefined') {\n                return;\n            }\n\n            plugins[name] = obj;\n\n            if (typeof obj.api !== 'undefined') {\n                Plugin.registerApi(name, obj);\n            }\n        }\n\n        static registerApi(name, obj) {\n            let api = obj.api();\n\n            if (typeof api === 'string') {\n                let api = obj.api().split('|');\n                let event = api[0] + `.plugin.${name}`;\n                let func = api[1] || 'render';\n\n                let callback = function(e) {\n                    let $el = (0, _jquery2.default)(this);\n                    let plugin = $el.data('pluginInstance');\n\n                    if (!plugin) {\n                        plugin = new obj($el, _jquery2.default.extend(true, {}, getDefaults(name), $el.data()));\n                        plugin.initialize();\n                        $el.data('pluginInstance', plugin);\n                    }\n\n                    plugin[func](e);\n                };\n\n                apis[name] = function(selector, context) {\n                    if (context) {\n                        (0, _jquery2.default)(context).off(event);\n                        (0, _jquery2.default)(context).on(event, selector, callback);\n                    } else {\n                        (0, _jquery2.default)(selector).on(event, callback);\n                    }\n                };\n            } else if (typeof api === 'function') {\n                apis[name] = api;\n            }\n        }\n\n    }\n\n    exports.default = Plugin;\n\n    /**\n     * @param {String} name\n     */\n    function getPluginAPI(name) {\n        if (typeof name === 'undefined') {\n            return apis;\n        } else {\n            return apis[name];\n        }\n    }\n\n    /**\n     * @param {String} name\n     */\n    function getPlugin(name) {\n        if (typeof plugins[name] !== 'undefined') {\n            return plugins[name];\n        } else {\n            // console.warn('Plugin:' + name + ' has no warpped class.');\n            return false;\n        }\n    }\n\n    /**\n     * @param {String} name\n     */\n    function getDefaults(name) {\n        let PluginClass = getPlugin(name);\n\n        if (PluginClass) {\n            return PluginClass.getDefaults();\n        } else {\n            return {};\n        }\n    }\n\n    /**\n     * @param {String} name\n     * @param {String} $el\n     * @param {String} options\n     */\n    function pluginFactory(name, $el, options = {}) {\n        let PluginClass = getPlugin(name);\n\n        if (PluginClass && typeof PluginClass.api === 'undefined') {\n            return new PluginClass($el, _jquery2.default.extend(true, {}, getDefaults(name), options));\n        } else if (_jquery2.default.fn[name]) {\n            let plugin = new Plugin($el, options);\n\n            plugin.getName = function() {\n                return name;\n            };\n\n            plugin.name = name;\n            return plugin;\n        } else if (typeof PluginClass.api !== 'undefined') {\n            return false;\n        } else {\n            // console.warn('Plugin:' + name + ' script is not loaded.');\n            return false;\n        }\n    }\n\n    exports.Plugin = Plugin;\n    exports.getPluginAPI = getPluginAPI;\n    exports.getPlugin = getPlugin;\n    exports.getDefaults = getDefaults;\n    exports.pluginFactory = pluginFactory;\n\n    return Plugin;\n});"],"names":["define","exports","_jquery","Object","defineProperty","value","pluginFactory","getDefaults","getPlugin","getPluginAPI","Plugin","undefined","obj","_jquery2","__esModule","plugins","apis","constructor","$el","options","name","this","getName","isRendered","render","default","fn","initialize","api","registerApi","split","event","func","callback","e","plugin","data","extend","selector","context","off","on","PluginClass"],"mappings":"AAEAA,mDAAO,CAAC,UAAW,WAAW,SAASC,QAASC,SAE5CC,OAAOC,eAAeH,QAAS,aAAc,CACzCI,OAAO,IAEXJ,QAAQK,cAAgBL,QAAQM,YAAcN,QAAQO,UAAYP,QAAQQ,aAAeR,QAAQS,YAASC,MAO1EC,IAL5BC,UAK4BD,IALMV,UAMpBU,IAAIE,WAAaF,IAAM,SACtBA,SAIfG,QAAU,GACVC,KAAO,SAELN,OACFO,YAAYC,SAAKC,+DAAU,QAClBC,KAAOC,KAAKC,eACZJ,IAAMA,SACNC,QAAUA,aACVI,YAAa,EAGtBD,gBACW,SAGXE,aACQX,SAASY,QAAQC,GAAGL,KAAKD,aAGlB,OAFFF,IAAIG,KAAKD,MAAMC,KAAKF,SAMjCQ,gBACQN,KAAKE,kBACE,OAGNC,cACAD,YAAa,6BAIX,mBAGKH,KAAMR,UACC,IAARA,MAIXG,QAAQK,MAAQR,SAEO,IAAZA,IAAIgB,KACXlB,OAAOmB,YAAYT,KAAMR,yBAIdQ,KAAMR,SACjBgB,IAAMhB,IAAIgB,SAEK,iBAARA,IAAkB,KACrBA,IAAMhB,IAAIgB,MAAME,MAAM,KACtBC,MAAQH,IAAI,qBAAgBR,MAC5BY,KAAOJ,IAAI,IAAM,SAEjBK,SAAW,SAASC,OAChBhB,KAAM,EAAIL,SAASY,SAASJ,MAC5Bc,OAASjB,IAAIkB,KAAK,kBAEjBD,SACDA,OAAS,IAAIvB,IAAIM,IAAKL,SAASY,QAAQY,QAAO,EAAM,GAAI9B,YAAYa,MAAOF,IAAIkB,SAC/ED,OAAOR,aACPT,IAAIkB,KAAK,iBAAkBD,SAG/BA,OAAOH,MAAME,IAGjBlB,KAAKI,MAAQ,SAASkB,SAAUC,SACxBA,YACI1B,SAASY,SAASc,SAASC,IAAIT,UAC/BlB,SAASY,SAASc,SAASE,GAAGV,MAAOO,SAAUL,cAE/CpB,SAASY,SAASa,UAAUG,GAAGV,MAAOE,eAG5B,mBAARL,MACdZ,KAAKI,MAAQQ,eAsBhBpB,UAAUY,kBACc,IAAlBL,QAAQK,OACRL,QAAQK,eAUdb,YAAYa,UACbsB,YAAclC,UAAUY,aAExBsB,YACOA,YAAYnC,cAEZ,UAlCfN,QAAQwB,QAAUf,OAiElBT,QAAQS,OAASA,OACjBT,QAAQQ,sBA7DcW,kBACE,IAATA,KACAJ,KAEAA,KAAKI,OA0DpBnB,QAAQO,UAAYA,UACpBP,QAAQM,YAAcA,YACtBN,QAAQK,uBA1Bec,KAAMF,SAAKC,+DAAU,GACpCuB,YAAclC,UAAUY,SAExBsB,kBAA0C,IAApBA,YAAYd,WAC3B,IAAIc,YAAYxB,IAAKL,SAASY,QAAQY,QAAO,EAAM,GAAI9B,YAAYa,MAAOD,UAC9E,GAAIN,SAASY,QAAQC,GAAGN,MAAO,KAC9Be,OAAS,IAAIzB,OAAOQ,IAAKC,gBAE7BgB,OAAOb,QAAU,kBACNF,MAGXe,OAAOf,KAAOA,KACPe,OACJ,OAAWO,YAAYd,KACnB,GAaRlB"}