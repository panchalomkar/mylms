{"version":3,"file":"task_filters.min.js","sources":["../../src/remuiblck/task_filters.js"],"sourcesContent":["define([\n    'jquery',\n    'core/custom_interaction_events',\n    'core/notification',\n    'local_edwiserpagebuilder/remuiblck/events',\n    'local_edwiserpagebuilder/remuiblck/task_view'\n], function(\n    $,\n    CustomEvents,\n    Notification,\n    RemuiblckEvents,\n    TaskView\n) {\n    var SELECTORS = {\n        TASK_DURATION_FILTER: '[data-region=\"task-duration-filter\"]',\n        TASK_STATUS_FILTER: '[data-region=\"task-status-filter\"]',\n        TASK_SEARCH_FILTER: '[data-region=\"task-search-filter\"]',\n        TASK_CANCEL_SEARCH: '[data-region=\"cancel-result\"]',\n        TASK_FILTER_OPTION: '[data-value]'\n    };\n\n    /**\n     * Event listener for the day selector (\"Next 7 days\", \"Next 30 days\", etc).\n     *\n     * @param {object} root The root element for the timeline block\n     */\n    var registerTaskDurationFilter = function(root) {\n        var taskDurationFilterContainer = $(root).find(SELECTORS.TASK_DURATION_FILTER);\n\n        CustomEvents.define(taskDurationFilterContainer, [CustomEvents.events.activate]);\n        taskDurationFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.TASK_FILTER_OPTION,\n            function(e, data) {\n\n                var option = $(e.target).closest(SELECTORS.TASK_FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    data.originalEvent.preventDefault();\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.TASK_DURATION_FILTER_CHANGE);\n\n                // Get the aria-label from the selected option\n                var ariaLabel = option.attr('aria-label');\n\n                // Update the button with ID \"taskduration\" - both title and inner span text\n                $('#taskduration').attr('title', ariaLabel).find('span').text(ariaLabel);\n\n                data.originalEvent.preventDefault();\n\n                TaskView.loadTasks(root, option.data('value'), getTaskStatus(root), getTaskSearch(root));\n            }\n        );\n    };\n\n    /**\n     * Get task duration dropdown selection\n     * @param  {DOM} root block DOM object\n     * @return {string} selected duration option\n     */\n    var getTaskDuration = function(root) {\n        return $(root).find(SELECTORS.TASK_DURATION_FILTER).find(SELECTORS.TASK_FILTER_OPTION + '.active').data('value');\n    };\n\n    /**\n     * Event listener for the day selector (\"Next 7 days\", \"Next 30 days\", etc).\n     *\n     * @param {object} root The root element for the timeline block\n     */\n    var registerTaskStatusFilter = function(root) {\n        var taskStatusFilterContainer = $(root).find(SELECTORS.TASK_STATUS_FILTER);\n        CustomEvents.define(taskStatusFilterContainer, [CustomEvents.events.activate]);\n        taskStatusFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.TASK_FILTER_OPTION,\n            function(e, data) {\n\n                var option = $(e.target).closest(SELECTORS.TASK_FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    data.originalEvent.preventDefault();\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.TASK_STATUS_FILTER_CHANGE);\n\n                // Get the aria-label from the selected option\n                var ariaLabel = option.attr('aria-label');\n\n                // Update the button with ID \"taskduration\" - both title and inner span text\n                $('#taskstatus').attr('title', ariaLabel).find('span').text(ariaLabel);\n\n                data.originalEvent.preventDefault();\n\n                TaskView.loadTasks(root, getTaskDuration(root), option.data('value'), getTaskSearch(root));\n            }\n        );\n    };\n\n    /**\n     * Get task status dropdown selection\n     * @param {DOM} root block DOM object\n     * @return {string} selected status option\n     */\n    var getTaskStatus = function(root) {\n        return $(root).find(SELECTORS.TASK_STATUS_FILTER).find(SELECTORS.TASK_FILTER_OPTION + '.active').data('value');\n    };\n\n    /**\n     * Event listener for the search input\n     *\n     * @param {object} root The root element for the timeline block\n     */\n    var registerTaskSearchFilter = function(root) {\n        var taskSearchFilterContainer = $(root).find(SELECTORS.TASK_SEARCH_FILTER);\n        taskSearchFilterContainer.on(\n            RemuiblckEvents.TASK_SEARCH_FILTER_CHANGE,\n            function() {\n                TaskView.loadTasks(root, getTaskDuration(root), getTaskStatus(root), $(this).val());\n            }\n        );\n    };\n\n    /**\n     * Get task search input\n     * @param {DOM} root block DOM object\n     * @return {string} search query\n     */\n    var getTaskSearch = function(root) {\n        return $(root).find(SELECTORS.TASK_SEARCH_FILTER).val();\n    };\n\n    /**\n     * Initialise task filters events\n     * @param {DOM} root block DOM object\n     */\n    var init = function(root) {\n        registerTaskDurationFilter(root);\n        registerTaskStatusFilter(root);\n        registerTaskSearchFilter(root);\n        $('body').on('click', SELECTORS.TASK_CANCEL_SEARCH, function(e) {\n            e.preventDefault();\n            $(root).find(SELECTORS.TASK_SEARCH_FILTER).val('').trigger('input');\n            return;\n        });\n    };\n    return {\n        init: init,\n        getTaskDuration: getTaskDuration,\n        getTaskStatus: getTaskStatus\n    };\n});\n"],"names":["define","$","CustomEvents","Notification","RemuiblckEvents","TaskView","SELECTORS","getTaskDuration","root","find","data","getTaskStatus","getTaskSearch","val","init","taskDurationFilterContainer","events","activate","on","e","option","target","closest","hasClass","originalEvent","preventDefault","trigger","TASK_DURATION_FILTER_CHANGE","ariaLabel","attr","text","loadTasks","registerTaskDurationFilter","taskStatusFilterContainer","TASK_STATUS_FILTER_CHANGE","registerTaskStatusFilter","TASK_SEARCH_FILTER_CHANGE","this","registerTaskSearchFilter"],"mappings":"AAAAA,yDAAO,CACH,SACA,iCACA,oBACA,4CACA,iDACD,SACCC,EACAC,aACAC,aACAC,gBACAC,cAEIC,+BACsB,uCADtBA,6BAEoB,qCAFpBA,6BAGoB,qCAHpBA,6BAIoB,gCAJpBA,6BAKoB,eA6CpBC,gBAAkB,SAASC,aACpBP,EAAEO,MAAMC,KAAKH,gCAAgCG,KAAKH,6BAA+B,WAAWI,KAAK,UA4CxGC,cAAgB,SAASH,aAClBP,EAAEO,MAAMC,KAAKH,8BAA8BG,KAAKH,6BAA+B,WAAWI,KAAK,UAuBtGE,cAAgB,SAASJ,aAClBP,EAAEO,MAAMC,KAAKH,8BAA8BO,aAiB/C,CACHC,KAXO,SAASN,OAlHa,SAASA,UAClCO,4BAA8Bd,EAAEO,MAAMC,KAAKH,gCAE/CJ,aAAaF,OAAOe,4BAA6B,CAACb,aAAac,OAAOC,WACtEF,4BAA4BG,GACxBhB,aAAac,OAAOC,SACpBX,8BACA,SAASa,EAAGT,UAEJU,OAASnB,EAAEkB,EAAEE,QAAQC,QAAQhB,iCAE7Bc,OAAOG,SAAS,UAEhBb,KAAKc,cAAcC,sBAIvBxB,EAAEkB,EAAEE,QAAQK,QAAQtB,gBAAgBuB,iCAGhCC,UAAYR,OAAOS,KAAK,cAG5B5B,EAAE,iBAAiB4B,KAAK,QAASD,WAAWnB,KAAK,QAAQqB,KAAKF,WAE9DlB,KAAKc,cAAcC,iBAEnBpB,SAAS0B,UAAUvB,KAAMY,OAAOV,KAAK,SAAUC,cAAcH,MAAOI,cAAcJ,WAwF1FwB,CAA2BxB,MArEA,SAASA,UAChCyB,0BAA4BhC,EAAEO,MAAMC,KAAKH,8BAC7CJ,aAAaF,OAAOiC,0BAA2B,CAAC/B,aAAac,OAAOC,WACpEgB,0BAA0Bf,GACtBhB,aAAac,OAAOC,SACpBX,8BACA,SAASa,EAAGT,UAEJU,OAASnB,EAAEkB,EAAEE,QAAQC,QAAQhB,iCAE7Bc,OAAOG,SAAS,UAEhBb,KAAKc,cAAcC,sBAIvBxB,EAAEkB,EAAEE,QAAQK,QAAQtB,gBAAgB8B,+BAGhCN,UAAYR,OAAOS,KAAK,cAG5B5B,EAAE,eAAe4B,KAAK,QAASD,WAAWnB,KAAK,QAAQqB,KAAKF,WAE5DlB,KAAKc,cAAcC,iBAEnBpB,SAAS0B,UAAUvB,KAAMD,gBAAgBC,MAAOY,OAAOV,KAAK,SAAUE,cAAcJ,WA4C5F2B,CAAyB3B,MAzBE,SAASA,MACJP,EAAEO,MAAMC,KAAKH,8BACnBY,GACtBd,gBAAgBgC,2BAChB,WACI/B,SAAS0B,UAAUvB,KAAMD,gBAAgBC,MAAOG,cAAcH,MAAOP,EAAEoC,MAAMxB,UAqBrFyB,CAAyB9B,MACzBP,EAAE,QAAQiB,GAAG,QAASZ,8BAA8B,SAASa,GACzDA,EAAEM,iBACFxB,EAAEO,MAAMC,KAAKH,8BAA8BO,IAAI,IAAIa,QAAQ,aAM/DnB,gBAAiBA,gBACjBI,cAAeA"}