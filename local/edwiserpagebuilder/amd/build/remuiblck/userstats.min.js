define("local_edwiserpagebuilder/remuiblck/userstats",["jquery","core/ajax","local_edwiserpagebuilder/remuiblck/chartjs","local_edwiserpagebuilder/remuiblck/bootstrap-select"],(function($,Ajax){var SELECTORS_PIE_CHART_BLOCK="#epb-pieChartblock",SELECTORS_COURSE_CATEGORY_LISTBLOCK="#epb-coursecategorylistblock",SELECTORS_ENROLL_STATS_NOUSERERROR=".epb-enroll-stats-nouserserror",SELECTORS_CHART_LEGEND=".epb-chart-legend",SELECTORS_ENROLL_STATS_ERROR=".epb-enroll-stats-error",myDoughnuts={},pieOptions={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:1,percentageInnerCutout:50,animationSteps:100,animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=value %> <%=label%> users",legend:{display:!1},plugins:{legend:{display:!1}}};function createpiechart(root,uniqid){var categoryId=$(root+" "+SELECTORS_COURSE_CATEGORY_LISTBLOCK+" option:selected").data("id");Ajax.call([{methodname:"local_edwiserpagebuilder_remuiblck_action",args:{action:"get_enrolled_users_by_category",config:JSON.stringify({categoryid:categoryId})}}])[0].done((function(response){if(null===(response=JSON.parse(response)))$(root+" canvas"+SELECTORS_PIE_CHART_BLOCK).hide(),$(root+" "+SELECTORS_ENROLL_STATS_NOUSERERROR).hide(),$(root+" "+SELECTORS_CHART_LEGEND).hide(),$(root+" "+SELECTORS_ENROLL_STATS_ERROR).show();else{$(root+" "+SELECTORS_ENROLL_STATS_ERROR).hide(),$(root+" "+SELECTORS_ENROLL_STATS_NOUSERERROR).hide(),$(root+" "+SELECTORS_CHART_LEGEND).show(),$(root+" canvas"+SELECTORS_PIE_CHART_BLOCK).show(),$(root+" "+SELECTORS_CHART_LEGEND).empty();var colors=["#264485","#0051F9","#37BE71","#4caf50","#8bc34a","#ffeb3b","#ff9800","#f44336","#9c27b0","#673ab7","#3f51b5"];$.each(response.labels,(function(index,value){$(root+" "+SELECTORS_CHART_LEGEND).append('<li class="list-group-item d-flex align-items-center flex-gap-4 p-0"><span class="badge badge-round text-trasparent" style="background-color:'+colors[index]+';">1</span><span >'+value+':<span class="st-count">'+response.data[index]+"</span></span></li>")})),function(response,root,uniqid){myDoughnuts[uniqid]&&null!==myDoughnuts[uniqid]&&myDoughnuts[uniqid].destroy();var pieChartCanvas=$(root+" "+SELECTORS_PIE_CHART_BLOCK).get(0).getContext("2d"),doughnutData={labels:response.labels,datasets:[{data:response.data,backgroundColor:response.background_color,hoverBackgroundColor:response.hoverBackground_color}]};myDoughnuts[uniqid]=new Chart(pieChartCanvas,{type:"doughnut",data:doughnutData,options:pieOptions})}(response,root,uniqid)}})).fail((function(){$(root+" canvas"+SELECTORS_PIE_CHART_BLOCK).hide(),$(root+" "+SELECTORS_ENROLL_STATS_ERROR).show()}))}return{init:function(root,uniqid){$(document).ready((function(){!function(root,uniqid){$(root+" select").length&&($(root+" select"+SELECTORS_COURSE_CATEGORY_LISTBLOCK).on("change",(function(){createpiechart(root,uniqid)})),createpiechart(root,uniqid)),$(root+" "+SELECTORS_COURSE_CATEGORY_LISTBLOCK).selectpicker()}(root,uniqid)}))}}}));

//# sourceMappingURL=userstats.min.js.map