{"version":3,"file":"content.min.js","sources":["../src/content.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * IOMAD Custom page content editor\n *\n * @module      local_iomadcustompage/content\n * @copyright   2021 David Matamoros <davidmc@moodle.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\"use strict\";\n\nimport 'core/inplace_editable';\nimport Notification from 'core/notification';\nimport {get_string as getString} from 'core/str';\nimport {add as addToast} from 'core/toast';\nimport * as pageSelectors from 'local_iomadcustompage/local/selectors';\nimport {createPageModal} from 'local_iomadcustompage/local/repository/modals';\n\nlet initialized = false;\n\n/**\n * Initialise editor and all it's modules\n */\nexport const init = () => {\n  // Ensure we only add our listeners once (can be called multiple times by mustache template).\n  if (initialized) {\n    return;\n  }\n\n  // Add event handlers to generic report editor elements.\n  document.addEventListener('click', event => {\n\n    // Edit report details modal.\n    const pageEdit = event.target.closest(pageSelectors.actions.pageEdit);\n    if (pageEdit) {\n      event.preventDefault();\n\n      const pageModal = createPageModal(event.target, getString('editpagedetails', 'local_iomadcustompage'),\n        pageEdit.dataset.pageId);\n      pageModal.addEventListener(pageModal.events.FORM_SUBMITTED, () => {\n        getString('pageupdated', 'local_iomadcustompage')\n          .then(addToast)\n          .then(() => {\n            return window.location.reload();\n          })\n          .catch(Notification.exception);\n      });\n      pageModal.show();\n    }\n  });\n\n  initialized = true;\n};\n"],"names":["e","_getRequireWildcardCache","WeakMap","r","t","Object","defineProperty","_exports","value","init","_notification","__esModule","default","pageSelectors","has","get","n","__proto__","a","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_interopRequireWildcard","initialized","document","addEventListener","event","pageEdit","target","closest","actions","preventDefault","pageModal","createPageModal","getString","dataset","pageId","events","FORM_SUBMITTED","get_string","then","addToast","add","window","location","reload","catch","Notification","exception","show"],"mappings":"sRA6BkE,IAAAA,EAAA,SAAAC,yBAAAD,GAAA,GAAA,mBAAAE,QAAA,OAAA,KAAA,IAAAC,EAAAD,IAAAA,QAAAE,EAAAF,IAAAA,eAAAD,yBAAA,SAAAD,GAAAA,OAAAA,EAAAI,EAAAD,IAAAH,EAAA,CANrDK,OAAAC,eAAAC,SAAA,aAAA,CAAAC,OAAA,IAAAD,SAAAE,UAAA,EAGbC,eAGkEV,EAHlEU,gBAGkEV,EAAAW,WAAAX,EAAAY,CAAAA,QAAAZ,GAAlEa,cAAkE,SAAAb,EAAAG,GAAAA,IAAAA,GAAAH,GAAAA,EAAAW,WAAAX,OAAAA,EAAAA,GAAAA,OAAAA,GAAAA,iBAAAA,GAAAA,mBAAAA,EAAAY,MAAAA,CAAAA,QAAAZ,GAAAI,IAAAA,EAAAH,yBAAAE,GAAA,GAAAC,GAAAA,EAAAU,IAAAd,GAAA,OAAAI,EAAAW,IAAAf,GAAA,IAAAgB,EAAA,CAAAC,UAAA,MAAAC,EAAAb,OAAAC,gBAAAD,OAAAc,yBAAA,IAAA,IAAAC,KAAApB,EAAAoB,GAAAA,YAAAA,GAAAC,CAAAA,EAAAA,eAAAC,KAAAtB,EAAAoB,GAAAG,CAAAA,IAAAA,EAAAL,EAAAb,OAAAc,yBAAAnB,EAAAoB,GAAAG,KAAAA,IAAAA,EAAAR,KAAAQ,EAAAC,KAAAnB,OAAAC,eAAAU,EAAAI,EAAAG,GAAAP,EAAAI,GAAApB,EAAAoB,GAAAJ,OAAAA,EAAAJ,QAAAZ,EAAAI,GAAAA,EAAAoB,IAAAxB,EAAAgB,GAAAA,CAAA,CAAlES,CAAAZ,eAGA,IAAIa,aAAc,EAkChBnB,SAAAE,KA7BkBA,KAEdiB,cAKJC,SAASC,iBAAiB,SAASC,QAGjC,MAAMC,SAAWD,MAAME,OAAOC,QAAQnB,cAAcoB,QAAQH,UAC5D,GAAIA,SAAU,CACZD,MAAMK,iBAEN,MAAMC,WAAY,EAAAC,QAAAA,iBAAgBP,MAAME,QAAQ,EAAAM,KAAAA,YAAU,kBAAmB,oBAC3EP,SAASQ,QAAQC,QACnBJ,UAAUP,iBAAiBO,UAAUK,OAAOC,gBAAgB,MAC1D,EAAAJ,KAASK,YAAC,cAAe,oBACtBC,KAAKC,OAAQC,KACbF,MAAK,IACGG,OAAOC,SAASC,WAExBC,MAAMC,cAAYtC,QAACuC,UAAU,IAElChB,UAAUiB,MACZ,KAGF1B,aAAc,EAAI,CAClB"}