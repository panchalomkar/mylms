define(["jquery","core/modal_factory","core/templates","core/str"],function(e,o,a,t){return{init:function(){setTimeout(function(){e("div.stimg.cardone-header .fa.fa-pencil-square-o").closest("a").css("display","none"),e(".editor_atto_toolbar .atto_collapse_button").css("display","none"),e("#id_error_message").html(""),e("#id_error_message").css("display","none"),e(".editor_atto_toolbar .atto_group.style1_group").css("display","none"),e(".editor_atto_toolbar .atto_group.list_group").css("display","none"),e(".editor_atto_toolbar .atto_group.links_group").css("display","none"),e(".editor_atto_toolbar .atto_group.style2_group").css("display","none"),e(".editor_atto_toolbar .atto_group.align_group").css("display","none"),e(".editor_atto_toolbar .atto_group.indent_group").css("display","none"),e(".editor_atto_toolbar .atto_group.insert_group").css("display","none"),e(".editor_atto_toolbar .atto_group.undo_group").css("display","none"),e(".editor_atto_toolbar .atto_group.accessibility_group").css("display","none"),e(".editor_atto_toolbar .atto_group.other_group").css("display","none"),e(".editor_atto_toolbar .atto_group.fontfamily_group").css("display","none"),e(".editor_atto_toolbar .atto_group.fontsize_group").css("display","none"),e(".editor_atto_toolbar .atto_group.fullscreen_group").css("display","none"),e("div.editor_atto_toolbar button.atto_wordimport_button").css("display","none"),e("div.editor_atto_toolbar button.atto_media_button").css("display","none"),e("div.editor_atto_toolbar button.atto_managefiles_button").css("display","none"),e("div.editor_atto_toolbar button.atto_recordrtc_button_audio").css("display","none"),e("div.editor_atto_toolbar button.atto_recordrtc_button_video").css("display","none"),e("div.editor_atto_toolbar button.atto_image_button").css("display","none");var l=t.get_string("uploadimage","local_social_wall");e.when(l).done(function(o){e('<button type="button" class="atto_custom_upload_image" tabindex="0" id="atto_custom_upload_image" title="'+o+'"><i class="icon fa fa-image fa-fw " title="'+o+'" aria-label="'+o+'"></i></button>').appendTo("div.files_group")});var s=t.get_string("uploadvideo","local_social_wall");e.when(s).done(function(o){e('<button type="button" class="atto_custom_upload_video" tabindex="0" id="atto_custom_upload_video" title="'+o+'"><i class="icon fa fa-video-camera fa-fw " title="'+o+'" aria-label="'+o+'"></i></button>').appendTo("div.files_group")});var i,r,n,d=t.get_string("uploadfiles","local_social_wall");e.when(d).done(function(o){e('<button type="button" class="atto_custom_upload_files" tabindex="0" id="atto_custom_upload_files" title="'+o+'"><i class="icon fa fa-file fa-fw " title="'+o+'" aria-label="'+o+'"></i></button>').appendTo("div.files_group")}),e(document).on("click","button#atto_custom_upload_image",function(){if(e("#socialfiles").val(""),e("#socialerror").html(""),e("#id_error_message").html(""),e("#id_error_message").css("display","none"),e("#socialimageupload").length)i.show();else{var s=e("#create-modal");o.create({title:l,body:a.render("local_social_wall/imagepopup",{}),footer:""},s).done(function(e){(i=e).show()})}e(document).on("change","#socialfiles",function(o){e("#socialimageerror").html(""),e("#socialimageerror").removeClass("alert alert-danger");var a=this.files[0],l=a.type,s=["image/jpeg","image/png","image/jpg"];if(a.size>5e6){var i=t.get_string("maxfilesizeallowed","local_social_wall",5);return e.when(i).done(function(o){e("#socialimageerror").addClass("alert alert-danger"),e("#socialimageerror").html(o),e("#socialfiles").val("")}),!1}if(l!=s[0]&&l!=s[1]&&l!=s[2]){var r=t.get_string("extensionallowed","local_social_wall");return e.when(r).done(function(o){e("#socialimageerror").addClass("alert alert-danger"),e("#socialimageerror").html(o),e("#socialfiles").val("")}),!1}}),e(document).one("submit","#socialimageupload",function(o){o.preventDefault();for(var a=new FormData(this),t=0;t<e("#socialfiles")[0].files.length;t++)a.append("file[]",e("#socialfiles")[0].files[t]);a.append("sesskey",M.cfg.sesskey),e(".uploadingloader").css("display","block"),e.ajax({url:M.cfg.wwwroot+"/local/social_wall/ajax/upload_images.php",dataType:"json",async:!0,cache:!1,contentType:!1,processData:!1,data:a,type:"POST",success:function(o){if(o.status){for(var a=0;a<o.url.length;a++)e('<img class="wallimage" />').attr({src:o.url[a]}).appendTo("#messageeditable");i.hide()}else{var t=document.createElement("span");t.innerHTML=o.message,t.setAttribute("class","alert alert-danger"),e("#socialerror").html(t)}e(".uploadingloader").css("display","none")}})})}),e(document).on("click","button#atto_custom_upload_video",function(){if(e("#socialvideofiles").val(""),e("#socialerror").html(""),e("#id_error_message").html(""),e("#id_error_message").css("display","none"),e("#messageeditable video").length>0){var l=t.get_string("filesallowed","local_social_wall");return e.when(l).done(function(o){e("#id_error_message").html(o),e("#id_error_message").css("display","block")}),!1}if(e("#socialvideoupload").length)r.show();else{var i=e("#create-video-modal");o.create({title:s,body:a.render("local_social_wall/videopopup",{}),footer:""},i).done(function(e){(r=e).show()})}e(document).on("change","#socialvideofiles",function(o){e("#socialvideoerror").html(""),e("#socialvideoerror").removeClass("alert alert-danger");var a=this.files[0],l=a.type;if(a.size>5e7){var s=t.get_string("maxfilesizeallowed","local_social_wall",50);return e.when(s).done(function(o){e("#socialvideoerror").addClass("alert alert-danger"),e("#socialvideoerror").html(o),e("#socialfiles").val(""),e("#socialvideofiles").val("")}),!1}if("video/mp4"!=l){var i=t.get_string("videoextensionallowed","local_social_wall");return e.when(i).done(function(o){e("#socialvideoerror").addClass("alert alert-danger"),e("#socialvideoerror").html(o),e("#socialfiles").val(""),e("#socialvideofiles").val("")}),!1}}),e(document).one("submit","#socialvideoupload",function(o){o.preventDefault(),e("#id_error_message").html(""),e("#id_error_message").css("display","none");for(var a=new FormData(this),l=0;l<e("#socialvideofiles")[0].files.length;l++)a.append("file[]",e("#socialvideofiles")[0].files[l]);a.append("sesskey",M.cfg.sesskey),e(".uploadingloader").css("display","block"),e.ajax({url:M.cfg.wwwroot+"/local/social_wall/ajax/upload_video.php",dataType:"json",async:!0,cache:!1,contentType:!1,processData:!1,data:a,type:"POST",success:function(o){if(o.status){if(e("#messageeditable video").length>0){var a=t.get_string("filesallowed","local_social_wall");return e.when(a).done(function(o){e("#id_error_message").html(o),e("#id_error_message").css("display","block")}),!1}for(var l=0;l<o.url.length;l++)e('<video controls muted controlsList="nodownload" class="wallvideo">Your browser does not support the video tag.</video>').attr({src:o.url[l]}).appendTo("#messageeditable");r.hide()}else{var s=document.createElement("span");s.innerHTML=o.message,s.setAttribute("class","alert alert-danger"),e("#socialerror").html(s)}e(".uploadingloader").css("display","none")}})})}),e(document).on("click","button#atto_custom_upload_files",function(){if(e("#socialfilesfiles").val(""),e("#socialerror").html(""),e("#id_error_message").html(""),e("#id_error_message").css("display","none"),e("#messageeditable files").length>10){var l=t.get_string("filesallowed","local_social_wall");return e.when(l).done(function(o){e("#id_error_message").html(o),e("#id_error_message").css("display","block")}),!1}if(e("#socialfilesupload").length)n.show();else{var s=e("#create-files-modal");o.create({title:d,body:a.render("local_social_wall/filespopup",{}),footer:""},s).done(function(e){(n=e).show()})}e(document).on("change","#socialfilesfiles",function(o){if(e("#socialfileerror").html(""),e("#socialfileerror").removeClass("alert alert-danger"),this.files[0].size>5e6){var a=t.get_string("maxfilesizeallowed","local_social_wall",5);return e.when(a).done(function(o){e("#socialfileerror").addClass("alert alert-danger"),e("#socialfileerror").html(o),e("#socialfiles").val(""),e("#socialfilesfiles").val("")}),!1}}),e(document).one("submit","#socialfilesupload",function(o){o.preventDefault(),e("#id_error_message").html(""),e("#id_error_message").css("display","none");for(var a=new FormData(this),l=0;l<e("#socialfilesfiles")[0].files.length;l++)a.append("file[]",e("#socialfilesfiles")[0].files[l]);a.append("sesskey",M.cfg.sesskey),e(".uploadingloader").css("display","block"),e.ajax({url:M.cfg.wwwroot+"/local/social_wall/ajax/upload_files.php",dataType:"json",async:!0,cache:!1,contentType:!1,processData:!1,data:a,type:"POST",success:function(o){if(o.status){if(e("#messageeditable files").length>10){var a=t.get_string("filesallowed","local_social_wall");return e.when(a).done(function(o){e("#id_error_message").html(o),e("#id_error_message").css("display","block")}),!1}for(var l=0;l<o.url.length;l++)e('<a href="'+o.url[l]+'" title="'+o.name[l]+'" class="wallfiles" target="_blank"><i class="'+o.fileClass[l]+'" ></i> '+o.name[l]+"</a><br>").appendTo("#messageeditable");n.hide()}else{var s=document.createElement("span");s.innerHTML=o.message,s.setAttribute("class","alert alert-danger"),e("#socialerror").html(s)}e(".uploadingloader").css("display","none")}})})});e(window).scroll(function(){e("video").each(function(){!function(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var o=e.getBoundingClientRect();return o.top>=0&&o.left>=0&&o.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&o.right<=(window.innerWidth||document.documentElement.clientWidth)}(e(this))?e(this)[0].pause():e(this)[0].play()})})},3e3)}}});