function countLikes(e){var a={};a.msg_id=e,a.mode="count_likes";var t=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;$.ajax({method:"POST",url:t,data:a,dataType:"json",async:!1}).done((function(a){$(".countlike"+e).text(a.data+" Likes")}))}function isTouchDevice(){return!(!("ontouchstart"in window)&&!navigator.msMaxTouchPoints)}function show_wall_message(e){try{var a=JSON.parse(e);void 0!==a.filename?($("#message_atto_image_urlentry").val(a.filename),$("#atto_image_preview").attr("src",a.filename),$("#atto_image_preview").show(),$("#message_atto_image_widthentry").val(a.width),$("#message_atto_image_heightentry").val(a.height),$("#message_atto_image_urlentry").focus(),$("#message_atto_image_urlentry").click()):($("#message_atto_image_urlentry").val(""),$.notify("Sorry, there was an error uploading your file","error"))}catch(e){$.notify("Sorry, there was an error uploading your file","error")}}function see_all_notifications(){$(".back_div").hide(),$(".timeline_div").show();var e={mode:"see_all_notifications"},a=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;$.ajax({method:"POST",url:a,data:e,dataType:"json",async:!1}).done((function(e){var a=JSON.parse(e.data);a.status&&$(".render_msgs").html(a.html)}))}function see_all_messages(e){$(".back_div").hide(),$(".timeline_div").show();var a=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey,t={mode:"back_from_timeline"};$.ajax({method:"POST",url:a,data:t,dataType:"json",async:!0,success:function(a){var t=JSON.parse(a.data);if(a.error)$.notify(a.error,"error");else if($(".render_msgs").html(t.html),$("div.stimg.cardone-header .fa.fa-pencil-square-o").closest("a").css("display","none"),0!=e){var o=$("#"+e).closest("a")[0].hash;$("html, body").animate({scrollTop:$(o).offset().top},1e3)}}})}if(define(["jquery","theme_remui/select2","core/str","theme_remui/notify","theme_remui/popover"],(function(e,a,t,o,s){return{init:function(){t.get_strings([{key:"delete_update",component:"local_social_wall"},{key:"delete_comment",component:"local_social_wall"},{key:"access_denied",component:"local_social_wall"},{key:"req_comment",component:"local_social_wall"}]);e(document).ready((function(){function a(){e(window).on("scroll",(function(a){if(!e(".notification-container").length&&e(window).scrollTop()==e(document).height()-e(window).height()){var o=e(".timeline_div").is(":visible");if(o&&e(".stbody").length<e(".all_posts_count").text())t(e(".stbody:last").attr("id").split("y")[1],o);if(!o&&e(".stbody").length<e(".count_post").text())t(e(".stbody:last").attr("id").split("y")[1],o)}}))}function t(t,o){e(window).off("scroll");var s='<div id="socialwalloader" class="item row" style="display: block; text-align: center;"><img class="no result_img" src="'+M.cfg.wwwroot+'/pix/i/loading.gif"></div>';e(".render_msgs").append(s);var i=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey,n={};if(o)n.mode="back_from_timeline";else{n.mode="timeline_messages";var l=e("#menusocial").val();null==l&&(l=0),n.companyid=l}n.lastId=t,e.ajax({method:"POST",url:i,data:n,dataType:"json",async:!0,success:function(t){var o=JSON.parse(t.data);t.error?e.notify(t.error,"error"):(e(".render_msgs").append(o.html),a(),e("#socialwalloader").remove())}})}e("#menusocial").select2(),e.notify.defaults({globalPosition:"bottom right",timeout:4e4}),e(".mform").submit((function(a){a.preventDefault();var t=e("#messageeditable").html();if(""==t)return e.notify(M.util.get_string("req_comment","local_social_wall"),"error"),!1;if(0==e("#messageeditable .wallimage").length+e("#messageeditable .wallvideo").length+e("#messageeditable .wallfiles").length+e("#messageeditable").text().length)return e.notify(M.util.get_string("req_comment","local_social_wall"),"error"),!1;var o=e(this).serializeArray(),s={};e(o).each((function(e,a){s[a.name]=a.value})),s["message[text]"]=t;var i=M.cfg.wwwroot+"/local/social_wall/ajax/add_message.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:i,data:s,dataType:"json",async:!1}).done((function(a){e("#messageeditable").html(""),a.error?e.notify(a.error,"error"):(e(".render_msgs").html(a.data),e("#id_submitbutton").val(a.btn),e("#update_msg_id").val(""),e("#textarea_container").hasClass("boxopen")&&(e("#textarea_container").slideToggle("fast").removeClass("boxopen"),e(".txt-learning").removeClass("hidden")),e.notify(a.message,a.status))}))})),e(document).on("click",".stdelete",(function(){var a={},t=e(this).attr("id");a.msg_id=t,a.mode="delete_message";var o=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;return confirm(M.util.get_string("delete_update","local_social_wall"))&&e.ajax({method:"POST",url:o,data:a,dataType:"json",async:!1}).done((function(a){"error"==a.status||e("#stbody"+t).slideUp(),e.notify(a.message,a.status)})),!1})),e(document).on("click",".stcommentdelete",(function(){var a=e(this).attr("id"),t={};t.comid=a,t.mode="delete_comment";var o=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;return confirm(M.util.get_string("delete_comment","local_social_wall"))&&e.ajax({method:"POST",url:o,data:t,dataType:"json",async:!1}).done((function(t){"error"==t.status||e("#stcommentbody"+a).slideUp("slow"),e.notify(t.message,t.status)})),!1})),e(document).on("click",".social_like",(function(){var a=e(this).attr("id").replace("ratings",""),t=e(this).data("value"),o={};o.id=a,o.rate_val=t,o.mode="rating";var s=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;return e.ajax({method:"POST",url:s,data:o,dataType:"json",async:!1}).done((function(t){t.error?e.notify(t.error,"error"):("like"==t.data?e("#ratings"+a).addClass("active"):"no-like"==t.data&&e("#ratings"+a).removeClass("active"),countLikes(a))})),!1})),e(document).on("click",".comment_button",(function(a){a.preventDefault();var t=e(this).data("id"),o=e("#upd_comid").val(),s=e("#ctextarea"+t).val();if(s=s.replace(/\+/g,"zx81plus"),cleanText=s.replace(/<\/?[^>]+(>|$)/g,""),flag=cleanText.replace(/\s/g,""),""==s||""==flag)alert(M.util.get_string("req_comment","local_social_wall"));else{s=(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/\+/g,"zx81plus")).replace(/\&/g,"zorilla")).replace(/[&]nbsp[;]/gi," ")).replace(/[&]Acirc[;]/gi," ")).replace(/[&]lt[;]/gi,"<")).replace(/[&]gt[;]/gi,">")).replace(/[&]quot[;]/gi,'"')).replace(/[&]amp[;]/gi,"pamzpam")).replace("&embed","@@@@embed")).replace("&autoplay","@@@@autoplay"),/WordLimit=1/.test(location.href)&&(wordNumCount=s.match(/\S+/g).length,s=wordNumCount>1?s+"\n ("+wordNumCount+" words)":s+"\n ("+wordNumCount+" word)");var i={};i.msg_id=t,i.cmntid=o,i.comment=s,i.mode="add_comment";var n=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:n,data:i,dataType:"json",async:!1}).done((function(a){a.error?e.notify(a.error,"error"):(e(".render_msgs").html(a.data),e.notify(a.message,a.status),e("#ctextarea"+t).val(""),e("#upd_comid").val(""),e("#ctextarea"+t).focus())}))}return!1})),e(document).on("click",".commentopen",(function(){var a=e(this).attr("id");e("#commentload"+a).slideToggle("slow"),e("#"+a+".commentopen").find("i").hasClass("fa-angle-down")?(e("#"+a+".commentopen").find("i").removeClass("fa-angle-down").addClass("fa-angle-up"),e("#stbody"+a+" .action-box").slideToggle("slow")):(e("#"+a+".commentopen").find("i").removeClass("fa-angle-up").addClass("fa-angle-down"),e("#stbody"+a+" .action-box").slideToggle("slow"))})),e(document).on("click",".stedit",(function(){var a=e(this).attr("id"),t=e("#stbody"+a+" .msg_content").html();e("#messageeditable").html(t),e("#update_msg_id").val(a),e("#id_submitbutton").val("Update"),e(window).scrollTop(e("#textarea_container").offset().top),e("#textarea_container").hasClass("hidden")&&(e("#textarea_container").slideToggle("slow").addClass("boxopen"),e(".txt-learning").addClass("hidden"))})),e(document).on("click",".stcommentedit",(function(){var a=e(this).attr("id"),t=e(this).data("id"),o=e(this).next().next().html().replace(/<\/?[^>]+(>|$)/g,"");e("textarea#ctextarea"+t).val(o),e("#upd_comid").val(a)})),e(document).on("click",".loadComments",(function(){var a=e(this).data("id"),t={};t.count=e(this).data("count"),t.msg_id=a,t.mode="load_more_comment";var o=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:o,data:t,dataType:"json",async:!1}).done((function(t){t.error?e.notify(t.error,"error"):(e("#commentload"+a).html(t.data),e(".loadComments").hide(),e(".hideComments").show(),e("#commentload"+a).css({"min-height":"270px","max-height":"270px","overflow-y":"scroll"}))}))})),e(document).on("click",".hideComments",(function(){var a=e(this).data("id"),t={};t.count=e(this).data("count"),t.msg_id=a,t.mode="load_more_comment";var o=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:o,data:t,dataType:"json",async:!1}).done((function(t){t.error?e.notify(t.error,"error"):(e("#commentload"+a).html(t.data),e(".loadComments").show(),e(".hideComments").hide(),e("#commentload"+a).removeAttr("style"))}))})),e(document).on("change","#menusocial",(function(){var a=e(this).val();e("#current_company").val(a);var t=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey,o={};o.companyid=a,o.mode="company_message",e.ajax({method:"POST",url:t,data:o,dataType:"json",async:!1}).done((function(a){var t=JSON.parse(a.data);a.error?e.notify(a.error,"error"):(console.log(t.img),e(".socail-img-container").css("background-image","url("+t.img+")"),e(".render_msgs").html(t.html))}))})),e("p.write").on("click",(function(){e("#textarea_container").hasClass("hidden")&&(e("#textarea_container").slideToggle("slow").addClass("boxopen"),e(".txt-learning").addClass("hidden"),e("#upload_container").hide(),e("#url_container").hide())})),e(".custom-form-buttons").on("click",(function(){e("#textarea_container").hasClass("boxopen")&&(e("#textarea_container").slideToggle("fast").removeClass("boxopen"),e(".txt-learning").removeClass("hidden"),e("#messageeditable").html(""))})),e(".upload-img i").click((function(){e(".upload-img input[type='file']").trigger("click")})),e(".upload-img").on("click",(function(){var a=e("#current_company").val(),t="";0!=a&&(t="&company="+a);var o=M.cfg.wwwroot+"/admin/settings.php?section=local_social_wall"+t;window.location=o})),e(".click_show_post").on("click",(function(){e(this).css("background-color","#1ba2dd"),e(".click_show_media").css("background-color","#fff"),e(".click_show_url").css("background-color","#fff"),e(".show_post").show(),e(".show_media").hide(),e(".show_url").hide()})),e(".click_show_media").on("click",(function(){e(this).css("background-color","#1ba2dd"),e(".click_show_post").css("background-color","#fff"),e(".click_show_url").css("background-color","#fff"),e(".show_media").show(),e(".show_post").hide(),e(".show_url").hide()})),e(".click_show_url").on("click",(function(){e(this).css("background-color","#1ba2dd"),e(".click_show_post").css("background-color","#fff"),e(".click_show_media").css("background-color","#fff"),e(".show_url").show(),e(".show_post").hide(),e(".show_media").hide()})),e("#btn_timeline").on("click",(function(a){e(".timeline_div").hide(),e(".back_div").show(),e("#social-container-1").hide(),e("#grid-row-1").hide(),e("#social-container-2").show(),e("#notify-box-1").hide(),e("#notify-box-2").show(),a.preventDefault();var t=e("#menusocial").val();null==t&&(t=0);var o=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey,s={};s.companyid=t,s.mode="timeline_messages",e.ajax({method:"POST",url:o,data:s,dataType:"json",async:!0,success:function(a){var t=JSON.parse(a.data);a.error?e.notify(a.error,"error"):(e(".render_msgs").html(t.html),e("div.stimg.cardone-header .fa.fa-pencil-square-o").closest("a").css("display","none"))}})})),e("#back_see_all_btn").on("click",(function(a){e(".back_div").hide(),e(".timeline_div").show(),a.preventDefault();var t=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey,o={mode:"back_from_timeline"};e.ajax({method:"POST",url:t,data:o,dataType:"json",async:!0,success:function(a){var t=JSON.parse(a.data);a.error?e.notify(a.error,"error"):(e(".render_msgs").html(t.html),e("div.stimg.cardone-header .fa.fa-pencil-square-o").closest("a").css("display","none"))}})})),e("#back_see_all_btn_1").on("click",(function(a){e(".back_div").hide(),e(".timeline_div").show(),e("#social-container-1").show(),e("#grid-row-1").show(),e("#social-container-2").hide(),e("#notify-box-1").show(),e("#notify-box-2").hide(),a.preventDefault();var t=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey,o={mode:"back_from_timeline"};e.ajax({method:"POST",url:t,data:o,dataType:"json",async:!0,success:function(a){var t=JSON.parse(a.data);a.error?e.notify(a.error,"error"):(e(".render_msgs").html(t.html),e("div.stimg.cardone-header .fa.fa-pencil-square-o").closest("a").css("display","none"))}})})),e(document).on("click",".getlikedata",(function(){var a=e(this).attr("id"),t=M.cfg.wwwroot+"/local/social_wall/ajax/whoslike_popup.php",o={};o.msgid=a,e.ajax({method:"POST",url:t,data:o,async:!1}).done((function(a){e("#whoslikedata").html(a)}))})),e(document).on("click","#notifications li",(function(){var a=e(this).attr("id");if(0==a)see_all_notifications();else{if(e(this).hasClass("viewed-notification")){var t=a.split("-"),o={};o.type=t[0],o.messageid=t[1],o.userid=t[2],o.datecreated=t[3],o.mode="readcomment";var s=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:s,data:o,dataType:"json",async:!1}).done((function(t){JSON.parse(t.data).status&&e("#"+a).removeClass("viewed-notification")}))}if(e(".notification-container").length)see_all_messages(a);else{var i=e(this).closest("a")[0].hash;e("html, body").animate({scrollTop:e(i).offset().top},1e3)}}})),e(document).on("click","#back_to_notification",(function(e){see_all_messages(0)})),e(document).on("click","#notification-list li",(function(){var a=e(this).attr("id"),t=a.split("-"),o={};o.type=t[0],o.messageid=t[1],o.userid=t[2],o.datecreated=t[3],o.mode="see_notified_post";var s=M.cfg.wwwroot+"/local/social_wall/ajax/message_ajax.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:s,data:o,dataType:"json",async:!1}).done((function(o){var s=JSON.parse(o.data);s.status&&(e(".render_msgs").html(s.html),e("#"+t[0]+"-"+t[1]+"-"+t[2]+"-"+t[3]).removeClass("viewed-notification"),e("#"+a+"-notificationlist").removeClass("viewed-notification"))}))})),e(document).on("click","#back-to-notification-btn",(function(){see_all_notifications()})),e(document).ready((function(){a()})),e(document).on("mouseover",".user-popover",(function(){if(""!=e(this).attr("id")){var a=e(this).attr("id").split("-"),t=a[1],o=a[2],s=M.cfg.wwwroot+"/local/social_wall/ajax/popover_ajax.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:s,data:{userid:t},async:!1,success:function(a){if(""!=a.city)var s=a.city+",";else s="";if(""!=a.city||""!=a.country)var i='class="fa fa-map-marker"';else i="";var n='<div class="media text-md-left">'+a[0]+'<div class="media-body"><h6 class="font-weight-bold mt-0" style="text-align:center;"><a href="">'+a.firstname+" "+a.lastname+'</a></h6><div style="text-align:center;"><i '+i+"></i> <span>"+s+a.country+'</span></div></div></div><div class="media-body user-popover-body" style="margin-top:3%;"><div style="text-align:center;">'+a.description+"</div></div>";e("#popover-"+t+"-"+o).popover({title:"",trigger:"hover",container:"body",content:n,html:!0,placement:"auto",viewport:{selector:'[id="popover-'+t+"-"+o+'"]',padding:20}}),e("#popover-"+t+"-"+o).popover("show")}})}})),e(document).on("click","#saveuserbio",(function(){if(1==validateForm()){var a=e("#mform4").serialize(),t=M.cfg.wwwroot+"/local/social_wall/ajax/popover_ajax.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:t,data:a,dataType:"json",async:!0,success:function(e){"error"==e?alert("User bio not updated"):(alert("User bio updated"),location.reload())}})}})),e(document).on("click",".div-color",(function(){var a=e(this).attr("bgcolor");e("#user_background_colour").val(a)}))}));e(".area_error").hide(),e(".user_bio_social").on("keydown keyup change",(function(){250==e(this).val().length?(e(".area_error").show(),e(".area_error").css("color","red")):e(".area_error").hide()})),e(document).on("mouseover","#btn_timeline",(function(){var a=e(this).attr("value"),t=M.cfg.wwwroot+"/local/social_wall/ajax/popover_ajax.php?sesskey="+M.cfg.sesskey;e.ajax({method:"POST",url:t,data:{userid:a},async:!1,success:function(a){if(""!=a.city)var t=a.city+",";else t="";if(""!=a.city||""!=a.country)var o='class="fa fa-map-marker"';else o="";var s='<div class="media text-md-left">'+a[0]+'<div class="media-body"><h6 class="font-weight-bold mt-0" style="text-align:center;"><a href="">'+a.firstname+" "+a.lastname+'</a></h6><div style="text-align:center;"><i '+o+"></i> <span>"+t+a.country+'</span></div></div></div><div class="media-body user-popover-body" style="margin-top:3%;"><div style="text-align:center;">'+a.description+"</div></div>";e("#btn_timeline").popover({title:"",trigger:"hover",container:"body",content:s,html:!0,placement:"auto",viewport:{selector:'[id="#btn_timeline"]',padding:20}}),e("#btn_timeline").popover("show")}})}))}}})),$("#page-local-social_wall-index").length>0&&$("#page-local-social_wall-index .render_msgs #show_load_msgs").length>0&&($(".cardone-header").length>0||$(".notification-container").length>0)){var e=$("#updates-box"),f=$(".render_msgs"),lastScrollTop=-100,firstOffset=e.offset().top,firstWidth=e.width(),ww=$(window).width(),isFixed=!1;ww>767&&$(window).scroll((function(a){if(!isFixed){var t=e.offset().top,o=e.height(),s=$(window).height(),i=$(window).scrollTop(),n=f.height(),l=f.offset().top;i>=firstOffset-15&&o+i<=n+l?"sticky"!=e.css("position")&&s+i>=t+o&&e.css({position:"sticky",bottom:"auto",top:10,width:firstWidth}):o+i>=n+l?e.css({position:"static",bottom:60,top:"auto",width:firstWidth}):e.css({position:"static",width:firstWidth}),lastScrollTop=i}}))}function details_in_popup(e){alert(e);var a,t=M.cfg.wwwroot+"/local/social_wall/ajax/popover_ajax.php?sesskey="+M.cfg.sesskey,o=e;return $.ajax({method:"POST",url:t,data:{userid:o},dataType:"json",async:!1,success:function(e){var a='<div class="media text-md-left"><img class="cardone-img-100 d-flex z-depth-1 mr-3" src="https://mdbootstrap.com/img/Photos/Avatars/img%20(8).jpg"alt="Generic placeholder image" style="height: 60px;width: 60px;border-radius: 50%;"><div class="media-body"><h6 class="font-weight-bold mt-0" style="text-align:center;"><a href="">'+e.firstname+" "+e.lastname+'</a></h6><div style="text-align:center;"><i class="fa-map-marker"></i><span>'+e.city+","+e.country+'</span></div></div></div><div class="media-body" style="margin-top:3%;"><div style="text-align:center;">Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<span>Paris,FR</span></div></div>';console.log(a)}}),console.log("jhjjkhjhj"+a),a}function validateForm(){var e=$('select[name="user_country"]').val(),a=$('input[name="user_city"]').val();return""==e?($("#validation-box").show(),$("#alert_content").text("Please select country"),$("#validation-box").show(0).delay(5e3).hide(0),!1):""!=a||""==e||($("#validation-box").show(),$("#alert_content").text("Please select city"),$("#validation-box").show(0).delay(5e3).hide(0),!1)}