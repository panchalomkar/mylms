{"version":3,"file":"profile.min.js","sources":["../src/profile.js"],"sourcesContent":["/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @module     theme_remui/profile\n * @copyright (c) 2023 WisdmLabs (https://wisdmlabs.com/)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\"use strict\";\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'core_message/message_drawer_helper'\n], function ($, Ajax, Notification, MessageDrawerHelper) {\n    var SELECTORS = {\n        ERROR: 'div#error-message',\n        DANGER: 'alert-danger',\n        SUCCESS: 'alert-success',\n        PROFILEABOUTMEWRAPPER: '.profile-about-me-wrapper',\n        EDITICON: '.about-me-edit-icon-wrapper .edw-icon-Edit',\n        CANCELICON: '.about-me-edit-icon-wrapper .edw-icon-Cancel',\n        EDITPROFILEDETAILSWRAPPER: '.edit-profile-details-wrapper',\n    };\n    function toggleProfileField(selector, value) {\n        var $col = $(selector).closest('.profile-item-col');\n        if (!value || value.trim() === '' || value.trim() == 'Select a country...') {\n            $col.addClass('d-none');\n        } else {\n            $col.removeClass('d-none');\n        }\n    }\n    $('#editprofile .form-horizontal #btn-save-changes').click(function () {\n        $(SELECTORS.ERROR).show();\n        $(SELECTORS.ERROR).removeClass(SELECTORS.DANGER).addClass(SELECTORS.SUCCESS);\n        $(SELECTORS.ERROR).find('p').html(\"Saving...\");\n\n        var fname = $('#first_name').val();\n        var lname = $('#surname').val();\n        var phonenumber = $('#phone_number').val();\n        var department = $('#department').val();\n        var country = $('#editprofile .form-horizontal #country option:selected').val();\n        var countryname = $('#editprofile .form-horizontal #country option:selected').text();\n        var city = $.trim($('#city').val());\n        var description = $.trim($('#description').val());\n        var address = $.trim($('#address').val());\n\n        if (fname === '') {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(M.util.get_string('enterfirstname', 'theme_remui'));\n            $('#first_name').focus();\n            return false;\n        }\n\n        if (lname === '') {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(M.util.get_string('enterlastname', 'theme_remui'));\n            $('#surname').focus();\n            return false;\n        }\n\n\n        var phonenoregex = /^\\d{10}$/;\n        if (!phonenumber == '') {\n            if (!phonenumber.match(phonenoregex)) {\n                $(SELECTORS.ERROR).show();\n                $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n                $(SELECTORS.ERROR).find('p').html(M.util.get_string('entervalidphoneno', 'theme_remui'));\n                $('#phone_number').focus();\n                return false;\n            }\n        }\n        if (address.length > 240) {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(\"max 250 chars are allowed\");\n            $('#address').focus();\n            return false;\n        }\n\n        if (fname.length > 100) {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(\"max 100 chars are allowed\");\n            $('#first_name').focus();\n            return false;\n        }\n\n        if (lname.length > 100) {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(\"max 100 chars are allowed\");\n            $('#surname').focus();\n            return false;\n        }\n        if (department.length > 100) {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(\"max 100 chars are allowed\");\n            $('#department').focus();\n            return false;\n        }\n\n        var promise = Ajax.call([{\n            methodname: 'theme_remui_save_user_profile_settings',\n            args: {\n                fname,\n                lname,\n                description,\n                city,\n                country,\n                phonenumber,\n                department,\n                address\n            }\n        }])[0];\n        promise.done(function (response) {\n            let profileData = JSON.parse(response);\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.DANGER).addClass(SELECTORS.SUCCESS);\n            $(SELECTORS.ERROR).find('p').css('margin', '0').html(M.util.get_string('detailssavedsuccessfully', 'theme_remui'));\n            setTimeout(function () {\n                $(SELECTORS.PROFILEABOUTMEWRAPPER).toggleClass('d-none');\n                $(SELECTORS.EDITPROFILEDETAILSWRAPPER).toggleClass('d-none');\n                $(SELECTORS.EDITICON).toggleClass('d-none');\n                $(SELECTORS.CANCELICON).toggleClass('d-none');\n                $('.profile-user').text(fname + \" \" + lname);\n                $('.usermenu a span.usertext').text(fname + \" \" + lname);\n                $('#user-description').html(profileData.description);\n                $('.prof-user-firstname').text(fname);\n                $('.prof-user-lastname').text(lname);\n                $('.prof-user-phone').text(phonenumber);\n                toggleProfileField('.prof-user-phone', phonenumber);\n                $('.prof-user-department').text(profileData.department);\n                toggleProfileField('.prof-user-department', profileData.department);\n                $('.prof-user-desc').html(profileData.description);\n                toggleProfileField('.prof-user-desc', profileData.description);\n                $('.prof-user-country').text(countryname);\n                toggleProfileField('.prof-user-country', countryname);\n                $('.prof-user-city').text(profileData.city);\n                toggleProfileField('.prof-user-city', profileData.city);\n                $('.prof-user-address').text(profileData.address);\n                toggleProfileField('.prof-user-address', profileData.address);\n            }, 1000);\n\n        })\n            .fail(function (ex) {\n                $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n                $(SELECTORS.ERROR).find('p')\n                    .css('margin', '0')\n                    .html(ex.errorcode + ' : ' + ex.error + ', ' + M.util.get_string('actioncouldnotbeperformed', 'theme_remui'));\n                Notification.exception(ex);\n            });\n\n        return false;\n    });\n\n    $(\".userbadgelink\").click(function () {\n        $(\"#aboutmetab\").trigger(\"click\");\n    });\n    $(\".usercontactsurl\").click(function () {\n        MessageDrawerHelper.show();\n        setTimeout(function () {\n            $(\"a[data-route='view-contacts']\").trigger(\"click\");\n        }, 200);\n\n    });\n    var summaryheight = $('.user-desc-target').height();\n    if (summaryheight > 110) {\n        $('.user-desc-target').find('#readmorebtn').removeClass('d-none');\n        $('.user-desc').addClass('ellipsis ellipsis-3');\n    }\n    $('#readmorebtn').on('click', function () {\n        $('.user-desc-target .user-desc').removeClass('ellipsis ellipsis-3');\n        $('.user-desc-target .user-desc').removeClass('ellipsis ellipsis-3');\n        $('.user-desc-target').find('#readmorebtn').addClass('d-none');\n        $('.user-desc-target').find('#readlessbtn').removeClass('d-none');\n    });\n    $('#readlessbtn').on('click', function () {\n        $('.user-desc-target .user-desc').addClass('ellipsis ellipsis-3');\n        $('.user-desc-target .user-desc').addClass('ellipsis ellipsis-3');\n        $('.user-desc-target').find('#readmorebtn').removeClass('d-none');\n        $('.user-desc-target').find('#readlessbtn').addClass('d-none');\n    });\n\n    $('.edit-profile-icon-wrapper .edw-icon-Edit').on('click', function () {\n        $(SELECTORS.PROFILEABOUTMEWRAPPER).addClass('d-none');\n        $(SELECTORS.EDITPROFILEDETAILSWRAPPER).removeClass('d-none');\n        $(SELECTORS.EDITICON).toggleClass('d-none');\n        $(SELECTORS.CANCELICON).toggleClass('d-none');\n        $(SELECTORS.ERROR).hide();\n    });\n\n    $('#btn-canel-changes').on('click', function () {\n        $(SELECTORS.EDITICON).toggleClass('d-none');\n        $(SELECTORS.CANCELICON).toggleClass('d-none');\n        $(SELECTORS.PROFILEABOUTMEWRAPPER).toggleClass('d-none');\n        $(SELECTORS.EDITPROFILEDETAILSWRAPPER).toggleClass('d-none');\n    });\n\n});\n"],"names":["define","$","Ajax","Notification","MessageDrawerHelper","SELECTORS","toggleProfileField","selector","value","$col","closest","trim","removeClass","addClass","click","show","find","html","fname","val","lname","phonenumber","department","country","countryname","text","city","description","address","M","util","get_string","focus","match","length","call","methodname","args","done","response","profileData","JSON","parse","css","setTimeout","toggleClass","fail","ex","errorcode","error","exception","trigger","height","on","hide"],"mappings":"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"}
