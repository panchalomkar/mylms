/**
 * @module     theme_remui/floating_add_block_handler
 * @copyright (c) 2020 WisdmLabs (https://wisdmlabs.com/)
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_remui/floating_add_block_handler",["jquery","core/ajax","core/toast"],(function($,Ajax,Toast){var SELECTOR_ADDBLOCKFLOATMENU="#add-block-float-menu ",SELECTOR_ADDBLOCKSPLITICONBTN="#add-block-float-menu .add-block-split-icon-btn",SELECTOR_FLOATADDBLOCKBUTTON="#add-block-float-menu .floating-add-block-button",SELECTOR_DNONE="d-none",elements=[".side-pre-link",".side-bottom-link",".side-top-link",".content-link",".full-width-top-link",".full-bottom-link"],blockregions=[],blockinviewport=[],getSelectedregion=(blocksectiondata,currentitem)=>{var data="";return blocksectiondata.forEach((element=>{if($(currentitem).attr("data-region")==element.regionid)return data=element,!1})),data},callAllFunctions=function(blocksectiondata,currentclickedelement){let scroll=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var currentsectionlink=getSelectedregion(blocksectiondata,currentclickedelement);scroll&&scrolltoelement(currentsectionlink),activeregionclassaddition(currentclickedelement),getAaddblockData(currentsectionlink.regionaddblockbutton)},getAaddblockData=currentactiveregoninfo=>{var html=$(currentactiveregoninfo).html();$(SELECTOR_FLOATADDBLOCKBUTTON).attr({href:$(html).attr("href"),"data-key":$(html).attr("data-key"),"data-url":$(html).attr("data-url"),id:$(html).attr("id")})},activeregionclassaddition=currentactiveregionlink=>{$(SELECTOR_ADDBLOCKFLOATMENU).find(".dropdown-item").removeClass("activeregion"),$(currentactiveregionlink).addClass("activeregion")},scrolltoelement=element=>{if("#block-region-side-pre"==element.regionid)$(".drawer-right").hasClass("show")||$('.drawer-toggler.drawer-right-toggle [data-action="toggle"]').click();else{var scrollPosition=$("".concat(element.regionid,"-indicator")).offset().top-$(window).height()/2+$("".concat(element.regionid,"-indicator")).height()/2;$("html, body").animate({scrollTop:scrollPosition},1e3)}var msg=M.util.get_string("floataddblockbtnregionselectionmsg","theme_remui",element.regionname);Toast.add(msg,{delay:3e3,closeButton:!0,type:"warning edw_toast"})};function findClosestID(ids){var viewportCenterX=$(window).scrollLeft()+$(window).width()/2,viewportCenterY=$(window).scrollTop()+$(window).height()/2,closestID=null,closestDistance=1/0;return $.each(ids,(function(index,id){var dx,dy,$element=$(id);if($element.length>0){var elementOffset=$element.offset(),elementCenterX=elementOffset.left+$element.width()/2,elementCenterY=elementOffset.top+$element.height()/2,distance=(dx=viewportCenterX-elementCenterX,dy=viewportCenterY-elementCenterY,Math.sqrt(dx*dx+dy*dy));distance<closestDistance&&(closestDistance=distance,closestID=id)}})),closestID}const registerCommonEvents=()=>{$(SELECTOR_ADDBLOCKSPLITICONBTN).click((function(){$("".concat(SELECTOR_ADDBLOCKSPLITICONBTN," .edw-icon-Down-Arrow")).toggleClass(SELECTOR_DNONE),$("".concat(SELECTOR_ADDBLOCKSPLITICONBTN," .edw-icon-UpArrow")).toggleClass(SELECTOR_DNONE)})),$(document).on("click",elements[0],(function(){callAllFunctions(blocksectiondata,this,!0)})),$(document).on("click",elements[1],(function(){callAllFunctions(blocksectiondata,this,!0)})),$(document).on("click",elements[2],(function(){callAllFunctions(blocksectiondata,this,!0)})),$(document).on("click",elements[3],(function(){callAllFunctions(blocksectiondata,this,!0)})),$(document).on("click",elements[4],(function(){callAllFunctions(blocksectiondata,this,!0)})),$(document).on("click",elements[5],(function(){callAllFunctions(blocksectiondata,this,!0)}))};return{init:function(){$(document).ready((function(){registerCommonEvents(),blocksectiondata.forEach((function(divID){var id=divID.regionid;blockregions.push(id)}));var closestID=findClosestID(blockregions);blockinviewport.push(closestID),blockinviewport.length>0?callAllFunctions(blocksectiondata,'a[data-region="'.concat(blockinviewport[0],'"]')):callAllFunctions(blocksectiondata,"a[data-region=#region-fullwidthtop-blocks")}))}}}));

//# sourceMappingURL=floating_add_block_handler.min.js.map