{"version":3,"file":"validatejson.min.js","sources":["../src/validatejson.js"],"sourcesContent":["/* eslint-disable no-console */\n/* eslint-disable jsdoc/require-jsdoc*/\n/* eslint-disable jsdoc/require-jsdoc*/\n/* eslint-disable jsdoc/require-jsdoc*/\n/* eslint-disable no-loop-func*/\n/* eslint-disable no-unused-vars */\n\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @module     theme_remui/validatejson\n * @copyright (c) 2023 WisdmLabs (https://wisdmlabs.com/)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function ($) {\n\n    var _scrollTopEle = false;\n\n    function isValidJSONString(_str) {\n        try {\n            JSON.parse(_str);\n        } catch (e) {\n\n            return false;\n        }\n        return true;\n    }\n\n    const toggleError = (_fieldele, action) => {\n        if (action) {\n            $(_fieldele).css(\"border-color\", \"red\");\n        } else {\n            $(_fieldele).css(\"border-color\", \"#ced4da\");\n        }\n    };\n\n    const validateMenuField = (_fieldele, _updateScrollTopEle = false) => {\n        // var _fieldele = \"#id_s_theme_remui_footercolumn\" + _elemIndex + \"menu\";\n        var _content = $(_fieldele).val();\n        var _validated = true;\n\n        if (_content !== \"\" || _content !== null || _content != undefined) {\n            if (!isValidJSONString(_content)) {\n                if (_validated && _updateScrollTopEle) {\n                    // Here we get first element to scroll\n                    _scrollTopEle = _fieldele;\n                }\n                _validated = false;\n                toggleError(_fieldele, true);\n            } else {\n                toggleError(_fieldele, false);\n            }\n        }\n        return _validated;\n    };\n\n    const validateMenuFields = (_elemIndex) => {\n        var _fieldele = \"#id_s_theme_remui_footercolumn\" + _elemIndex + \"menu\";\n        var _validated = true;\n        for (var i = 4; i >= 1; i--) {\n            _validated = validateMenuField(_fieldele, true);\n        }\n        var container = $('.settingsform');\n        if (!_validated) {\n            $([document.documentElement, document.body]).animate({\n                scrollTop: $(_scrollTopEle).offset().top - container.offset().top + container.scrollTop()\n            }, 500);\n            _scrollTopEle = false;\n        }\n        return _validated;\n    };\n\n    const registerValidationEvents = () => {\n        $(\"#id_s_theme_remui_footercolumn1menu\").on(\"focusout\", function () {\n            validateMenuField(\"#id_s_theme_remui_footercolumn1menu\");\n        });\n        $(\"#id_s_theme_remui_footercolumn2menu\").on(\"focusout\", function () {\n            validateMenuField(\"#id_s_theme_remui_footercolumn2menu\");\n        });\n        $(\"#id_s_theme_remui_footercolumn3menu\").on(\"focusout\", function () {\n            validateMenuField(\"#id_s_theme_remui_footercolumn3menu\");\n        });\n        $(\"#id_s_theme_remui_footercolumn4menu\").on(\"focusout\", function () {\n            validateMenuField(\"#id_s_theme_remui_footercolumn4menu\");\n        });\n    };\n    const allEqual = arr => arr.every(val => val === true);\n    return {\n        init: function () {\n            // add event listener for text area.\n            // for (var i = 4; i >= 1; i--) {\n            //     var _fieldele = \"#id_s_theme_remui_footercolumn\"+i+\"menu\";\n            //     $(_fieldele).on(\"focusout\", function(){\n            //         validateMenuField(_fieldele);\n            //     });\n            // }\n            registerValidationEvents();\n\n            const submitbtn = \"#adminsettings .settingsform .btn[type='submit']\";\n            $(submitbtn).on('click', function (e) {\n                var linktofootersetting = $('a[href=\"#theme_remui_footer\"]');\n                if (linktofootersetting.hasClass('active') && linktofootersetting.text() == M.util.get_string('footersettings', 'theme_remui') && linktofootersetting.attr('aria-selected')) {\n                    e.preventDefault();\n                    var _validatallfields = [];\n                    // _validatallfields[0] = true;\n                    for (var i = 1; i <= 4; i++) {\n                        if ($('#admin-footercolumn'+i+'menu').css('display') !== 'none') {\n                            _validatallfields[i] = validateMenuFields(i);\n                        }\n                    }\n                    if (allEqual(_validatallfields)) {\n                        $(\"#adminsettings\").submit();\n                    }\n\n                }\n            });\n        }\n    };\n});\n"],"names":["define","$","_scrollTopEle","isValidJSONString","_str","JSON","parse","e","toggleError","_fieldele","action","css","validateMenuField","_updateScrollTopEle","_content","val","_validated","undefined","validateMenuFields","_elemIndex","i","container","document","documentElement","body","animate","scrollTop","offset","top","init","on","linktofootersetting","hasClass","text","M","util","get_string","attr","preventDefault","_validatallfields","every","submit"],"mappings":";;;;;AA4BAA,kCAAO,CAAC,WAAW,SAAUC,OAErBC,eAAgB,WAEXC,kBAAkBC,UAEnBC,KAAKC,MAAMF,MACb,MAAOG,UAEE,SAEJ,QAGLC,YAAc,CAACC,UAAWC,UACxBA,OACAT,EAAEQ,WAAWE,IAAI,eAAgB,OAEjCV,EAAEQ,WAAWE,IAAI,eAAgB,YAInCC,kBAAoB,SAACH,eAAWI,gFAE9BC,SAAWb,EAAEQ,WAAWM,MACxBC,YAAa,QAEA,KAAbF,UAAgC,OAAbA,UAAiCG,MAAZH,WACnCX,kBAAkBW,UAQnBN,YAAYC,WAAW,IAPnBO,YAAcH,sBAEdX,cAAgBO,WAEpBO,YAAa,EACbR,YAAYC,WAAW,KAKxBO,YAGLE,mBAAsBC,qBACpBV,UAAY,iCAAmCU,WAAa,OAC5DH,YAAa,EACRI,EAAI,EAAGA,GAAK,EAAGA,IACpBJ,WAAaJ,kBAAkBH,WAAW,OAE1CY,UAAYpB,EAAE,wBACbe,aACDf,EAAE,CAACqB,SAASC,gBAAiBD,SAASE,OAAOC,QAAQ,CACjDC,UAAWzB,EAAEC,eAAeyB,SAASC,IAAMP,UAAUM,SAASC,IAAMP,UAAUK,aAC/E,KACHxB,eAAgB,GAEbc,kBAkBJ,CACHa,KAAM,WAfN5B,EAAE,uCAAuC6B,GAAG,YAAY,WACpDlB,kBAAkB,0CAEtBX,EAAE,uCAAuC6B,GAAG,YAAY,WACpDlB,kBAAkB,0CAEtBX,EAAE,uCAAuC6B,GAAG,YAAY,WACpDlB,kBAAkB,0CAEtBX,EAAE,uCAAuC6B,GAAG,YAAY,WACpDlB,kBAAkB,0CAgBlBX,EADkB,oDACL6B,GAAG,SAAS,SAAUvB,OAC3BwB,oBAAsB9B,EAAE,oCACxB8B,oBAAoBC,SAAS,WAAaD,oBAAoBE,QAAUC,EAAEC,KAAKC,WAAW,iBAAkB,gBAAkBL,oBAAoBM,KAAK,iBAAkB,CACzK9B,EAAE+B,yBACEC,kBAAoB,GAEfnB,EAAI,EAAGA,GAAK,EAAGA,IACqC,SAArDnB,EAAE,sBAAsBmB,EAAE,QAAQT,IAAI,aACtC4B,kBAAkBnB,GAAKF,mBAAmBE,IAGrCmB,kBAxBDC,OAAMzB,MAAe,IAARA,OAyBrBd,EAAE,kBAAkBwC"}