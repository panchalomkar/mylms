define("theme_remui/customizer",["exports","jquery","core/ajax","core/notification","core/modal_factory","core/modal_save_cancel","core/modal_events","theme_remui/customizer/utils","theme_remui/customizer/global-site","theme_remui/customizer/global-body","theme_remui/customizer/global-colors","theme_remui/customizer/global-heading","theme_remui/customizer/global-buttons","theme_remui/customizer/header-logo","theme_remui/customizer/header-design","theme_remui/customizer/footer","theme_remui/customizer/additional-settings","theme_remui/customizer/icon-settings","theme_remui/customizer/quicksetup-settings","theme_remui/customizer/login","theme_remui/color-picker","theme_remui/feedbackcollection"],(function(_exports,_jquery,_ajax,_notification,_modal_factory,_modal_save_cancel,_modal_events,_utils,_globalSite,_globalBody,_globalColors,_globalHeading,_globalButtons,_headerLogo,_headerDesign,_footer,_additionalSettings,_iconSettings,_quicksetupSettings,_login,_colorPicker,_feedbackcollection){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * @module     theme_remui/customizer
   * @copyright  (c) 2023 WisdmLabs (https://wisdmlabs.com/)
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   * @author     Yogesh Shirsath
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=function(){if(1==window["customizer-enabled"])return;window["customizer-enabled"]=!0,localStorage.setItem(CONSTANTS_CURRNIGHTEYESTATE,localStorage.getItem(CONSTANTS_NIGHTEYESTATE)),localStorage.setItem(CONSTANTS_NIGHTEYESTATE,2),(0,_jquery.default)((()=>{handlers.forEach((handler=>handler.init())),(0,_jquery.default)(document).trigger("edwiser.customizer.init"),(0,_jquery.default)(SELECTOR_COLOR_RESET).on("click",(function(){let color=(0,_jquery.default)(this).data("default");(0,_jquery.default)(this).closest(".form-group").find("input").spectrum("set",color),(0,_jquery.default)(this).closest(".form-group").find("input").trigger("color.changed",color)})),(0,_jquery.default)(SELECTOR_CHECKBOX_RESET).on("click",(function(){let value=(0,_jquery.default)(this).data("default");(0,_jquery.default)(this).closest(".form-group").find("input").prop("checked",(0,_jquery.default)(this).closest(".form-group").find("input").val()==value),(0,_jquery.default)(this).closest(".form-group").find("input").trigger("change").trigger("input")})),(0,_jquery.default)(SELECTOR_SELECT_RESET).on("click",(function(){let value=(0,_jquery.default)(this).data("default");(0,_jquery.default)(this).closest(".form-group").find("select").val(value).trigger("input").trigger("change")})),(0,_jquery.default)(SELECTOR_INPUT_RESET).on("click",(function(){let value=(0,_jquery.default)(this).data("default");(0,_jquery.default)(this).closest(".form-group").find("input").val(value).trigger("input").trigger("change")})),(0,_jquery.default)(SELECTOR_TEXTAREA_RESET).on("click",(function(){let value=(0,_jquery.default)(this).data("default");(0,_jquery.default)(this).closest(".form-group").find("textarea").val(value).trigger("input").trigger("change")})),(0,_jquery.default)(SELECTOR_HTMLEDITOR_RESET).on("click",(function(){let value=(0,_jquery.default)(this).data("default"),textarea=(0,_jquery.default)(this).closest(".form-group").find("textarea");(0,_jquery.default)(this).closest(".form-group").find("#".concat(textarea.attr("id"),"editable")).html(value),textarea.val(value).trigger("input").trigger("change")})),(0,_jquery.default)(SELECTOR_IFRAME).attr("src",(0,_jquery.default)(SELECTOR_IFRAME).data("src")),(0,_jquery.default)(SELECTOR_IFRAME).get(0).addEventListener("load",iframeHandler),(0,_jquery.default)(SELECTOR_SETTINGS_RESET).on("click",resetAllSettingHandler),(0,_jquery.default)(SELECTOR_PANEL_LINK).on("click",(function(){(0,_jquery.default)(SELECTOR_PANEL+"#"+(0,_jquery.default)(this).data(SELECTOR_PANEL_ID)).addClass(SELECTOR_CURRENT),(0,_jquery.default)(this).closest(SELECTOR_PANEL).removeClass(SELECTOR_CURRENT)})),(0,_jquery.default)(SELECTOR_SETTINGS_SAVE_MODAL+' [data-action="close"]').on("click",(function(){(0,_jquery.default)(SELECTOR_SETTINGS_SAVE_MODAL).modal("hide")})),(0,_jquery.default)("body").on("click",(function(e){var container=(0,_jquery.default)(SELECTOR_SETTINGS_SAVE_MODAL);container.is(e.target)||0!==container.has(e.target).length||container.modal("hide")})),(0,_jquery.default)(SELECTOR_PANEL_BACK).on("click",(function(){(0,_jquery.default)(SELECTOR_PANEL+":not("+SELECTOR_PANEL+"#"+(0,_jquery.default)(this).data(SELECTOR_PANEL_ID)+")").removeClass(SELECTOR_CURRENT),(0,_jquery.default)(SELECTOR_PANEL+"#"+(0,_jquery.default)(this).data(SELECTOR_PANEL_ID)).addClass(SELECTOR_CURRENT)})),(0,_jquery.default)(SELECTOR_MODE_TOGGLE).on("click",(function(){(0,_jquery.default)(SELECTOR_CUSTOMIZER).removeClass("mode-desktop mode-tablet mode-mobile").addClass("mode-".concat((0,_jquery.default)(this).data("mode")))})),(0,_jquery.default)(SELECTOR_CONTROLS).on("submit",(function(event){return event.preventDefault(),!1})),(0,_jquery.default)("\n            ".concat(SELECTOR_CONTROLS,' input[type="text"],\n            ').concat(SELECTOR_CONTROLS,' input[type="number"],\n            ').concat(SELECTOR_CONTROLS,' input[type="checkbox"]\n            ').concat(SELECTOR_CONTROLS," textarea,\n            ").concat(SELECTOR_CONTROLS," select\n        ")).on("change",(function(){(0,_jquery.default)(SELECTOR_CONTROLS).data("unsaved",!0)})),(0,_jquery.default)("".concat(SELECTOR_CONTROLS,' input[type="color"]')).on("color.changed",(function(){(0,_jquery.default)(SELECTOR_CONTROLS).data("unsaved",!0)})),(0,_jquery.default)(SELECTOR_PUBLISH).on("click",publishChanges),(0,_jquery.default)(SELECTOR_CLOSE_CUSTOMIZER).on("click",closeCustomizer),(0,_jquery.default)(SELECTOR_CUSTMIZER_TOGGLE).on("click",(function(){(0,_jquery.default)("body").toggleClass("full-customizer")})),(0,_jquery.default)(SELECTOR_HEADING_TOGGLE).on("click",(function(){(0,_jquery.default)(this).toggleClass("collapsed"),(0,_jquery.default)(this).next().slideToggle("fast")})),(0,_jquery.default)("body").on("input",SELECTOR_RANGEINPUT,(function(){let id=(0,_jquery.default)(this).attr("id"),value=(0,_jquery.default)(this).val();(0,_jquery.default)("#".concat(id,"-range-value")).text(value)})),(0,_jquery.default)(".previewswitchon").on("click",(function(){localStorage.setItem(CONSTANTS_NIGHTEYESTATE,1),(0,_jquery.default)(SELECTOR_IFRAME).attr("src",(0,_jquery.default)(SELECTOR_IFRAME).data("src")),(0,_jquery.default)("#customizer").addClass("showdm"),(0,_jquery.default)(".previewswitchon").addClass("d-none"),(0,_jquery.default)(".previewswitchoff").removeClass("d-none"),(0,_jquery.default)(".customizer-panels").css("overflow-y","hidden")})),(0,_jquery.default)(".previewswitchoff").on("click",(function(){localStorage.setItem(CONSTANTS_NIGHTEYESTATE,2),(0,_jquery.default)(SELECTOR_IFRAME).attr("src",(0,_jquery.default)(SELECTOR_IFRAME).data("src")),(0,_jquery.default)("#customizer").removeClass("showdm"),(0,_jquery.default)(".previewswitchoff").addClass("d-none"),(0,_jquery.default)(".previewswitchon").removeClass("d-none"),(0,_jquery.default)(".customizer-panels").css("overflow-y","auto")}))}))},_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_utils=_interopRequireDefault(_utils),_globalSite=_interopRequireDefault(_globalSite),_globalBody=_interopRequireDefault(_globalBody),_globalColors=_interopRequireDefault(_globalColors),_globalHeading=_interopRequireDefault(_globalHeading),_globalButtons=_interopRequireDefault(_globalButtons),_headerLogo=_interopRequireDefault(_headerLogo),_headerDesign=_interopRequireDefault(_headerDesign),_footer=_interopRequireDefault(_footer),_additionalSettings=_interopRequireDefault(_additionalSettings),_iconSettings=_interopRequireDefault(_iconSettings),_quicksetupSettings=_interopRequireDefault(_quicksetupSettings),_login=_interopRequireDefault(_login),_feedbackcollection=_interopRequireDefault(_feedbackcollection);var PROMISES_SAVE_SETTINGS=(settings,options)=>(null==options&&(options={}),_ajax.default.call([{methodname:"theme_remui_customizer_save_settings",args:{settings:JSON.stringify(settings),options:JSON.stringify(options)}}])[0]),handlers=[_globalSite.default,_globalBody.default,_globalColors.default,_globalHeading.default,_globalButtons.default,_headerLogo.default,_headerDesign.default,_footer.default,_additionalSettings.default,_iconSettings.default,_quicksetupSettings.default,_login.default],SELECTOR_CUSTOMIZER="#customizer",SELECTOR_CONTROLS="#customize-controls",SELECTOR_MODE_TOGGLE="#customize-controls .mode-toggle",SELECTOR_CLOSE_CUSTOMIZER=".customize-controls-close",SELECTOR_CUSTMIZER_TOGGLE=".customizer-controls-toggle",SELECTOR_PUBLISH="#publish-settings",SELECTOR_IFRAME="#customizer-frame",SELECTOR_MAIN_OVERLAY="#main-overlay",SELECTOR_PANEL_LINK="[sidebar-panel-link]",SELECTOR_PANEL_BACK=".customize-panel-back",SELECTOR_PANEL=".sidebar-panel",SELECTOR_PANEL_ID="panel-id",SELECTOR_CURRENT="current",SELECTOR_SETTINGS_RESET="#reset-settings",SELECTOR_INPUT_RESET=".input-reset",SELECTOR_SELECT_RESET=".select-reset",SELECTOR_CHECKBOX_RESET=".checkbox-reset",SELECTOR_COLOR_RESET=".color-reset",SELECTOR_TEXTAREA_RESET=".textarea-reset",SELECTOR_HTMLEDITOR_RESET=".htmleditor-reset",SELECTOR_HEADING_TOGGLE=".heading-toggle",SELECTOR_RANGEINPUT=".form-range",SELECTOR_SETTINGS_SAVE_MODAL="#settings-save-modal",CONSTANTS_NIGHTEYESTATE="nighteyewState",CONSTANTS_CURRNIGHTEYESTATE="currnighteyewState";function iframeHandler(){var contentDocument=_utils.default.getDocument(),contentWindow=_utils.default.getWindow();(0,_jquery.default)(contentDocument).find("body").addClass("customizer-opened"),(0,_jquery.default)(contentDocument).find(".customizer-editing-icon").closest("a").addClass("d-none").removeClass("d-flex"),(0,_jquery.default)(contentDocument).find("#edwpersonalizer-settings .activatepersonalizer").addClass("d-none"),(0,_jquery.default)(contentDocument).find("#edwpersonalizer-settings .activepersonalizer").removeClass("d-none"),(0,_jquery.default)(contentDocument).find("#sidebar-setting").addClass("d-none"),(0,_jquery.default)(contentDocument).find(".nav-darkmode").addClass("d-none").removeClass("d-flex"),(0,_jquery.default)(document).trigger("remui-adjust-left-side"),window.history.replaceState("pagechange",document.title,M.cfg.wwwroot+"/theme/remui/customizer.php?url="+encodeURI(contentWindow.location.href)),(0,_jquery.default)(SELECTOR_CLOSE_CUSTOMIZER).attr("href",contentWindow.location.href),handlers.forEach((handler=>handler.apply())),(0,_jquery.default)(document).trigger("edwiser.customizer.apply"),_utils.default.hideLoader(),setTimeout((()=>{contentWindow.onbeforeunload=function(){console.log("Iframe navigated."),_utils.default.showLoader()}}),2e3)}function resetAllSettingHandler(){let body=M.util.get_string("reset-settings-description","theme_remui");body+='<ul class"pl-5">',["customcss","socialall","loginpagesitedescription","footerprivacypolicy","footertermsandconditions","footercolumnsettings"].forEach((id=>{body+="<li>"+M.util.get_string(id,"theme_remui")+"</li>"})),body+="</ul>",_modal_factory.default.create({title:M.util.get_string("reset","moodle"),body:body,type:_modal_factory.default.types.SAVE_CANCEL},(0,_jquery.default)("#create-modal")).done((modal=>{modal.show();var root=modal.getRoot();function reset(settings){(0,_jquery.default)(SELECTOR_MAIN_OVERLAY).removeClass("d-none"),modal.destroy(),PROMISES_SAVE_SETTINGS(settings,{reset:!0}).done((()=>{location.reload()})).fail((ex=>{_notification.default.exception(ex)}))}root.find('[data-region="footer"]').html('\n            <button type="button" class="btn btn-outline-danger" data-action="reset-all">\n                '.concat(M.util.get_string("resetall","theme_remui"),'\n            </button>\n            <button type="button" class="btn btn-danger" data-action="reset-some">\n                ').concat(M.util.get_string("reset","theme_remui"),"\n            </button>\n        ")),root.on("click",'[data-action="reset-all"]',(()=>{reset([])})),root.on("click",'[data-action="reset-some"]',(()=>{reset(function(){let element,settings=[],ids=["customcss","facebooksetting","twittersetting","linkedinsetting","gplussetting","youtubesetting","instagramsetting","pinterestsetting","quorasetting","whatsappsetting","telegramsetting","footerprivacypolicy","footertermsandconditions","brandlogotext","footercolumn","footercolumnsize","poweredbyedwiser","footerprivacypolicyshow"];for(let i=1;i<=4;i++)ids.push("footercolumn"+i+"type"),ids.push("footercolumn"+i+"title"),ids.push("footercolumn"+i+"customhtml"),ids.push("socialmediaiconcol"+i),ids.push("footercolumn"+i+"social"),ids.push("footercolumn"+i+"menu");return ids.forEach((id=>{element=(0,_jquery.default)('[name="'+id+'"]'),element.closest(".fitem").find(".reset-button").trigger("click"),element.is('[type="checkbox"]')?settings.push({name:id,value:element.is(":checked")}):element.is("select[multiple]")?element.val().forEach((value=>{settings.push({name:id,value:value})})):settings.push({name:id,value:element.val()})})),settings}())}))}))}function publishChanges(){console.log("Saving setting to site."),(0,_jquery.default)(SELECTOR_MAIN_OVERLAY).removeClass("d-none");let settings=(0,_jquery.default)(SELECTOR_CONTROLS).serializeArray();settings.forEach(((element,index)=>{(0,_jquery.default)('[name="'.concat(element.name,'"]')).is(".site-colorpicker")&&(element.value=(0,_jquery.default)('[name="'.concat(element.name,'"]')).spectrum("get").toString(),settings[index]=element)})),PROMISES_SAVE_SETTINGS(settings).done((response=>{let obj={};0==response.status?(obj.title=M.util.get_string("error","theme_remui"),obj.body=response.errors):(obj.title=M.util.get_string("success","moodle"),obj.body=response.message,(0,_jquery.default)(SELECTOR_CONTROLS).data("unsaved",!1)),console.log("Settings saved."),location.reload()})).fail((function(ex){console.log("Error:"+ex.message),_notification.default.exception(ex),(0,_jquery.default)(SELECTOR_MAIN_OVERLAY).addClass("d-none")}))}function closeCustomizer(event){return 0==(0,_jquery.default)(SELECTOR_CONTROLS).data("unsaved")||(event.preventDefault(),_modal_factory.default.create({title:M.util.get_string("customizer-close-heading","theme_remui"),body:M.util.get_string("customizer-close-description","theme_remui"),type:_modal_factory.default.types.SAVE_CANCEL},(0,_jquery.default)("#create")).done((modal=>{modal.show(),modal.setSaveButtonText(M.util.get_string("yes","moodle")),modal.getRoot().on(_modal_events.default.save,(async()=>{const feedbackcontext=await _feedbackcollection.default.get_feedback_context("visualpersonalizer_question");JSON.parse(feedbackcontext)?(_feedbackcollection.default.render_feedbackform("visualpersonalizer_question",(function(){(0,_jquery.default)(document).on("click","#feedbackcollection-form .skip-btn",(function(){window.location=(0,_jquery.default)(SELECTOR_CLOSE_CUSTOMIZER).attr("href")})),(0,_jquery.default)(document).on("submit","#feedbackcollection-form",(function(e){e.preventDefault(),window.location=(0,_jquery.default)(SELECTOR_CLOSE_CUSTOMIZER).attr("href")}))})),console.log("inside feedback collection")):window.location=(0,_jquery.default)(SELECTOR_CLOSE_CUSTOMIZER).attr("href")}))})),localStorage.setItem(CONSTANTS_NIGHTEYESTATE,localStorage.getItem(CONSTANTS_CURRNIGHTEYESTATE))),!0}}));

//# sourceMappingURL=customizer.min.js.map