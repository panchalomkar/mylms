/**
 * @module     theme_remui/focusmode
 * @copyright (c) 2023 WisdmLabs (https://wisdmlabs.com/)
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_remui/focusmode",["jquery","theme_remui/notice","core/str","theme_remui/user/repository"],(function($,Notice,Str,UserRepository){return{init:function(action){$(document).ready((function(){var SELECTORS,_obj,strings,focusmode=(SELECTORS={BODY:"body",BUTTON_FULLSCREEN:"#toggleFullscreen",FM_BUTTON:"#focusmodebutton",FM_BUTTON_ICON:"#focusmodebutton i",SECTION_WRAPPER:".stepprogress-section",SECTION_ITEM:".stepprogress-item",SECTION:".section",ACTIVITY:".activity",GO_BACK:"#go-back",FOCUS_MODE_CLASS:"focusmode",FOCUS_MODE_TEXT:"#focusmodebutton .btn-floating-text",FOCUS_MODE_DROPDOWN_TOGGLE:".focus-dropdown .dropdown-toggle"},strings=[{key:"focusmodeenabled",component:"theme_remui"},{key:"focusmodedisabled",component:"theme_remui"}],(_obj={fmstatus:action}).initFocusMode=function(){Str.get_strings(strings).then((function(results){strings=results,_obj.setupFocusMode(),_obj.initEvents()}))},_obj.setupFocusMode=function(){"activate"==(_obj.fmstatus?"activate":"deactivate")&&Notice.info(strings[0])},_obj.initEvents=function(){$(SELECTORS.FM_BUTTON).on("click",(function(){_obj.toggleFocusMode()})),$(SELECTORS.FOCUS_MODE_DROPDOWN_TOGGLE).on("click",(function(){$(this).toggleClass("active")}))},_obj.changeFMButtonClasses=function(action){"activate"===action&&($(SELECTORS.BODY).addClass(SELECTORS.FOCUS_MODE_CLASS),$(SELECTORS.FM_BUTTON).addClass("btn-danger").removeClass("btn-primary"),$(SELECTORS.FM_BUTTON).attr("aria-pressed","true"),$(SELECTORS.FM_BUTTON_ICON).removeClass().addClass("edw-icon edw-icon-Cancel"),$(SELECTORS.FOCUS_MODE_TEXT).text(M.util.get_string("focusmodeactivestatetext","theme_remui"))),"deactivate"===action&&($(SELECTORS.BODY).removeClass(SELECTORS.FOCUS_MODE_CLASS),$(SELECTORS.FM_BUTTON).removeClass("btn-danger").addClass("btn-primary"),$(SELECTORS.FM_BUTTON).attr("aria-pressed","false"),$(SELECTORS.FM_BUTTON_ICON).removeClass().addClass("edw-icon edw-icon-Expand"),$(SELECTORS.FOCUS_MODE_TEXT).text(M.util.get_string("focusmodenormalstatetext","theme_remui"))),$("#page.drawers.show-drawer-left .drawer-left-toggle button").click(),$("#page.drawers.show-drawer-right .drawer-right-toggle button").click()},_obj.toggleFocusMode=async function(){var _$oldprefences$prefer,action,status,tostr;_obj.fmstatus?(action="deactivate",status=!1,tostr=strings[1]):(action="activate",status=!0,tostr=strings[0]),_obj.changeFMButtonClasses(action),_obj.fmstatus=status,$oldprefences=await UserRepository.getUserPreferences("enable_focus_mode");let userfocusmodepref={};const courseid=M.cfg.courseId;if("string"==typeof(null===(_$oldprefences$prefer=$oldprefences.preferences[0])||void 0===_$oldprefences$prefer?void 0:_$oldprefences$prefer.value))try{const parsedData=JSON.parse($oldprefences.preferences[0].value);userfocusmodepref="object"==typeof parsedData&&null!==parsedData?parsedData:{}}catch(e){userfocusmodepref={}}userfocusmodepref[courseid]=_obj.fmstatus,UserRepository.setUserPreference("enable_focus_mode",JSON.stringify(userfocusmodepref)),Notice.info(tostr)},_obj);focusmode.initFocusMode()}))}}}));

//# sourceMappingURL=focusmode.min.js.map