/**
 * @module     theme_remui/profile
 * @copyright (c) 2023 WisdmLabs (https://wisdmlabs.com/)
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_remui/profile",["jquery","core/ajax","core/notification","core_message/message_drawer_helper"],(function($,Ajax,Notification,MessageDrawerHelper){var SELECTORS_ERROR="div#error-message",SELECTORS_DANGER="alert-danger",SELECTORS_SUCCESS="alert-success",SELECTORS_PROFILEABOUTMEWRAPPER=".profile-about-me-wrapper",SELECTORS_EDITICON=".about-me-edit-icon-wrapper .edw-icon-Edit",SELECTORS_CANCELICON=".about-me-edit-icon-wrapper .edw-icon-Cancel",SELECTORS_EDITPROFILEDETAILSWRAPPER=".edit-profile-details-wrapper";function toggleProfileField(selector,value){var $col=$(selector).closest(".profile-item-col");value&&""!==value.trim()&&"Select a country..."!=value.trim()?$col.removeClass("d-none"):$col.addClass("d-none")}$("#editprofile .form-horizontal #btn-save-changes").click((function(){$(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_DANGER).addClass(SELECTORS_SUCCESS),$(SELECTORS_ERROR).find("p").html("Saving...");var fname=$("#first_name").val(),lname=$("#surname").val(),phonenumber=$("#phone_number").val(),department=$("#department").val(),country=$("#editprofile .form-horizontal #country option:selected").val(),countryname=$("#editprofile .form-horizontal #country option:selected").text(),city=$.trim($("#city").val()),description=$.trim($("#description").val()),address=$.trim($("#address").val());if(""===fname)return $(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_SUCCESS).addClass(SELECTORS_DANGER),$(SELECTORS_ERROR).find("p").html(M.util.get_string("enterfirstname","theme_remui")),$("#first_name").focus(),!1;if(""===lname)return $(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_SUCCESS).addClass(SELECTORS_DANGER),$(SELECTORS_ERROR).find("p").html(M.util.get_string("enterlastname","theme_remui")),$("#surname").focus(),!1;return""!=!phonenumber||phonenumber.match(/^\d{10}$/)?address.length>240?($(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_SUCCESS).addClass(SELECTORS_DANGER),$(SELECTORS_ERROR).find("p").html("max 250 chars are allowed"),$("#address").focus(),!1):fname.length>100?($(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_SUCCESS).addClass(SELECTORS_DANGER),$(SELECTORS_ERROR).find("p").html("max 100 chars are allowed"),$("#first_name").focus(),!1):lname.length>100?($(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_SUCCESS).addClass(SELECTORS_DANGER),$(SELECTORS_ERROR).find("p").html("max 100 chars are allowed"),$("#surname").focus(),!1):department.length>100?($(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_SUCCESS).addClass(SELECTORS_DANGER),$(SELECTORS_ERROR).find("p").html("max 100 chars are allowed"),$("#department").focus(),!1):(Ajax.call([{methodname:"theme_remui_save_user_profile_settings",args:{fname:fname,lname:lname,description:description,city:city,country:country,phonenumber:phonenumber,department:department,address:address}}])[0].done((function(response){let profileData=JSON.parse(response);$(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_DANGER).addClass(SELECTORS_SUCCESS),$(SELECTORS_ERROR).find("p").css("margin","0").html(M.util.get_string("detailssavedsuccessfully","theme_remui")),setTimeout((function(){$(SELECTORS_PROFILEABOUTMEWRAPPER).toggleClass("d-none"),$(SELECTORS_EDITPROFILEDETAILSWRAPPER).toggleClass("d-none"),$(SELECTORS_EDITICON).toggleClass("d-none"),$(SELECTORS_CANCELICON).toggleClass("d-none"),$(".profile-user").text(fname+" "+lname),$(".usermenu a span.usertext").text(fname+" "+lname),$("#user-description").html(profileData.description),$(".prof-user-firstname").text(fname),$(".prof-user-lastname").text(lname),$(".prof-user-phone").text(phonenumber),toggleProfileField(".prof-user-phone",phonenumber),$(".prof-user-department").text(profileData.department),toggleProfileField(".prof-user-department",profileData.department),$(".prof-user-desc").html(profileData.description),toggleProfileField(".prof-user-desc",profileData.description),$(".prof-user-country").text(countryname),toggleProfileField(".prof-user-country",countryname),$(".prof-user-city").text(profileData.city),toggleProfileField(".prof-user-city",profileData.city),$(".prof-user-address").text(profileData.address),toggleProfileField(".prof-user-address",profileData.address)}),1e3)})).fail((function(ex){$(SELECTORS_ERROR).removeClass(SELECTORS_SUCCESS).addClass(SELECTORS_DANGER),$(SELECTORS_ERROR).find("p").css("margin","0").html(ex.errorcode+" : "+ex.error+", "+M.util.get_string("actioncouldnotbeperformed","theme_remui")),Notification.exception(ex)})),!1):($(SELECTORS_ERROR).show(),$(SELECTORS_ERROR).removeClass(SELECTORS_SUCCESS).addClass(SELECTORS_DANGER),$(SELECTORS_ERROR).find("p").html(M.util.get_string("entervalidphoneno","theme_remui")),$("#phone_number").focus(),!1)})),$(".userbadgelink").click((function(){$("#aboutmetab").trigger("click")})),$(".usercontactsurl").click((function(){MessageDrawerHelper.show(),setTimeout((function(){$("a[data-route='view-contacts']").trigger("click")}),200)})),$(".user-desc-target").height()>110&&($(".user-desc-target").find("#readmorebtn").removeClass("d-none"),$(".user-desc").addClass("ellipsis ellipsis-3")),$("#readmorebtn").on("click",(function(){$(".user-desc-target .user-desc").removeClass("ellipsis ellipsis-3"),$(".user-desc-target .user-desc").removeClass("ellipsis ellipsis-3"),$(".user-desc-target").find("#readmorebtn").addClass("d-none"),$(".user-desc-target").find("#readlessbtn").removeClass("d-none")})),$("#readlessbtn").on("click",(function(){$(".user-desc-target .user-desc").addClass("ellipsis ellipsis-3"),$(".user-desc-target .user-desc").addClass("ellipsis ellipsis-3"),$(".user-desc-target").find("#readmorebtn").removeClass("d-none"),$(".user-desc-target").find("#readlessbtn").addClass("d-none")})),$(".edit-profile-icon-wrapper .edw-icon-Edit").on("click",(function(){$(SELECTORS_PROFILEABOUTMEWRAPPER).addClass("d-none"),$(SELECTORS_EDITPROFILEDETAILSWRAPPER).removeClass("d-none"),$(SELECTORS_EDITICON).toggleClass("d-none"),$(SELECTORS_CANCELICON).toggleClass("d-none"),$(SELECTORS_ERROR).hide()})),$("#btn-canel-changes").on("click",(function(){$(SELECTORS_EDITICON).toggleClass("d-none"),$(SELECTORS_CANCELICON).toggleClass("d-none"),$(SELECTORS_PROFILEABOUTMEWRAPPER).toggleClass("d-none"),$(SELECTORS_EDITPROFILEDETAILSWRAPPER).toggleClass("d-none")}))}));

//# sourceMappingURL=profile.min.js.map
