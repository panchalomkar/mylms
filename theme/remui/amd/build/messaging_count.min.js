/**
 * @module     theme_remui/messaging_count
 * @copyright (c) 2023 WisdmLabs (https://wisdmlabs.com/)
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_remui/messaging_count",["jquery","core/ajax","core/notification","core/pubsub","core_message/message_drawer_router","core_message/message_drawer_routes","core_message/message_drawer_events"],(function($,Ajax,Notification,PubSub,Router,Routes,MessageDrawerEvents){let getUserCountListPromise=null;const getUserCount=function(){getUserCountListPromise||(getUserCountListPromise=new Promise((resolve=>{Ajax.call([{methodname:"theme_remui_get_msg_contact_list_count",args:{userid:1},done:function(data){const parsedData=$.parseJSON(data);resolve(parsedData)},fail:function(){console.log(Notification.exception)}}])}))),getUserCountListPromise.then((data=>{!function(data){$(".show-contacts-section span").remove(),$(".show-contacts-section").append(data.showmsgcount),$('[data-action="show-requests-section"] span').remove(),$('[data-action="show-requests-section"]').append(data.showrequestcount)}(data)})).catch((error=>{console.error("Error fetching user count:",error)}))};return{init:function(){$(document).ready((function(){getUserCount(),PubSub.subscribe(MessageDrawerEvents.CONVERSATION_READ,(function(){Ajax.call([{methodname:"theme_remui_get_login_user_detail",args:{},done:function(data){$(".send .messager-info .messager-img-container").remove(),$(".send .messager-info .username").remove(),$(".send .messager-info").append(data)},fail:function(){console.log(Notification.exception)}}])})),PubSub.subscribe(MessageDrawerEvents.CONTACT_ADDED,(function(){getUserCount()})),PubSub.subscribe(MessageDrawerEvents.CONTACT_REMOVED,(function(){getUserCount()})),PubSub.subscribe(MessageDrawerEvents.CONTACT_REQUEST_ACCEPTED,getUserCount()),PubSub.subscribe(MessageDrawerEvents.CONTACT_REQUEST_DECLINED,getUserCount()),$("[data-action='decline-contact-request']").on("click",(function(){setTimeout(getUserCount,100)}))}))}}}));

//# sourceMappingURL=messaging_count.min.js.map