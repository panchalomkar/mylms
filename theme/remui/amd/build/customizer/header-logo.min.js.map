{"version":3,"file":"header-logo.min.js","sources":["../../src/customizer/header-logo.js"],"sourcesContent":["/* eslint-disable no-console, no-unused-vars */\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * Theme customizer header-site-identity js\n * @copyright (c) 2023 WisdmLabs (https://wisdmlabs.com/) <support@wisdmlabs.com>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author    Yogesh Shirsath\n */\n\nimport $ from 'jquery';\nimport Utils from 'theme_remui/customizer/utils';\n\n/**\n * Selectors\n */\nvar SELECTOR = {\n    BASE: 'header-site-identy',\n    COLORCSS: 'header-icon-color',\n    IDENTITYPREFIX: 'header-site-identity',\n    LOGOORSITENAME: '[name=\"logoorsitename\"]',\n    ICON: '[name=\"siteicon\"]',\n    FONTSIZE: '[name=\"header-site-identity-fontsize\"]',\n    FONTSIZETABLET: '[name=\"header-site-identity-fontsize-tablet\"]',\n    LOGO: '[name=\"logo\"]',\n    LOGOMINI: '[name=\"logomini\"]',\n    BACKGROUNDCOLOR: '[name=\"header-background-color\"]',\n    SITENAMECOLOR: '[name=\"sitenamecolor\"]',\n    LOGOBGCOLOR: '[name=\"logo-bg-color\"]',\n    DARKMODELOGO: '[name=\"darkmodelogo\"]',\n    DARKMODELOGOMINI: '[name=\"darkmodelogomini\"]',\n    FOOTER: {\n        SHOWLOGO: '[name=\"footershowlogo\"]',\n        USEHEADER: '[name=\"useheaderlogo\"]'\n    }\n};\n\nvar CONSTANTS = {\n    NIGHTEYESTATE: 'nighteyewState',\n    CURRNIGHTEYESTATE: 'currnighteyewState'\n};\n/**\n * True if footer logo is on and use header checked.\n * @returns {boolean}\n */\nvar useForFooter = () => $(SELECTOR.FOOTER.SHOWLOGO).is(':checked') && $(SELECTOR.FOOTER.USEHEADER).is(':checked');\n\n/**\n * Handle site logo selector.\n */\nfunction logoSelectorHandler() {\n    let itemid, siteicon, content, sitename;\n    let iframeDocument = Utils.getDocument();\n    $(`\n        ${SELECTOR.ICON},\n        ${SELECTOR.FONTSIZE},\n        ${SELECTOR.LOGO},\n        ${SELECTOR.LOGOMINI},\n        ${SELECTOR.BACKGROUNDCOLOR},\n        ${SELECTOR.SITENAMECOLOR},\n        ${SELECTOR.DARKMODELOGO},\n        ${SELECTOR.DARKMODELOGOMINI}\n    `).closest('.setting-item').addClass('d-none');\n    switch ($(SELECTOR.LOGOORSITENAME).val()) {\n        case 'logo':\n            $(`${SELECTOR.LOGO}`).closest('.setting-item').removeClass('d-none');\n            $(`${SELECTOR.DARKMODELOGO}`).closest('.setting-item').removeClass('d-none');\n\n            itemid = $(SELECTOR.LOGO).val();\n            if(localStorage.getItem(CONSTANTS.NIGHTEYESTATE) == 1) {\n                itemid = $(SELECTOR.DARKMODELOGO).val();\n            }\n            Utils.getFileURL(itemid).done(function(response) {\n                if (response == '') {\n                    response = M.cfg.wwwroot + '/theme/remui/pix/logo.png';\n                }\n                var content = `<img src=\"${response}\" class=\"navbar-brand-logo logo\">`;\n                $(iframeDocument).find('nav.navbar .navbar-brand').empty().append(content);\n                $(iframeDocument).find('.drawer-left .drawerheader .navbar-brand').empty().append(content);\n                if (useForFooter()) {\n                    $(iframeDocument)\n                            .find(\"#page-footer .navbar-logo-footer-wrapper .navbar-brand\")\n                            .html(content);\n                }\n            });\n            break;\n        case 'logomini':\n            $(`${SELECTOR.LOGOMINI}`).closest('.setting-item').removeClass('d-none');\n            $(`${SELECTOR.DARKMODELOGOMINI}`).closest('.setting-item').removeClass('d-none');\n\n            itemid = $(SELECTOR.LOGOMINI).val();\n            if(localStorage.getItem(CONSTANTS.NIGHTEYESTATE) == 1) {\n                itemid = $(SELECTOR.DARKMODELOGOMINI).val();\n            }\n\n            Utils.getFileURL(itemid).done(function(response) {\n                if (response == '') {\n                    response = M.cfg.wwwroot + '/theme/remui/pix/logomini.png';\n                }\n                var content = `<img src=\"${response}\" class=\"navbar-brand-logo logomini\">`;\n                $(iframeDocument).find('nav.navbar .navbar-brand').empty().append(content);\n                $(iframeDocument).find('.drawer-left .drawerheader .navbar-brand').empty().append(content);\n                if (useForFooter()) {\n                    $(iframeDocument)\n                            .find(\"#page-footer .navbar-logo-footer-wrapper .navbar-brand\")\n                            .html(content);\n                }\n            });\n            break;\n        case 'icononly':\n            $(`${SELECTOR.ICON}, ${SELECTOR.FONTSIZE}, ${SELECTOR.SITENAMECOLOR}`).closest('.setting-item').removeClass('d-none');\n\n            siteicon = $(SELECTOR.ICON).val();\n            content = `<span class=\"navbar-brand-logo icononly\"><i class=\"fa fa-${siteicon}\"></i></span>`;\n            $(iframeDocument).find('nav.navbar .navbar-brand').empty().append(content);\n            $(iframeDocument).find('.drawer-left .drawerheader .navbar-brand').empty().append(content);\n            if (useForFooter()) {\n                $(iframeDocument)\n                        .find(\"#page-footer .navbar-logo-footer-wrapper .navbar-brand\")\n                        .html(content);\n            }\n            break;\n        case 'iconsitename':\n            $(`${SELECTOR.ICON}, ${SELECTOR.FONTSIZE}, ${SELECTOR.SITENAMECOLOR}`).closest('.setting-item').removeClass('d-none');\n            siteicon = $(SELECTOR.ICON).val();\n            sitename = $(\"#customizer\").attr(\"data-sitename\");\n            content = `<span class=\"navbar-brand-logo iconsitename\" ><i class=\"fa fa-${siteicon}\"></i>&nbsp;${sitename}\n            </span>`;\n            $(iframeDocument).find('nav.navbar .navbar-brand').empty().append(content);\n            $(iframeDocument).find('.drawer-left .drawerheader .navbar-brand').empty().append(content);\n            if (useForFooter()) {\n                $(iframeDocument)\n                        .find(\"#page-footer .navbar-logo-footer-wrapper .navbar-brand\")\n                        .html(content);\n            }\n            break;\n    }\n\n    let body = $(iframeDocument).find('body');\n    body.removeClass(`\n        ${SELECTOR.IDENTITYPREFIX}-logo\n        ${SELECTOR.IDENTITYPREFIX}-logomini\n        ${SELECTOR.IDENTITYPREFIX}-icononly\n        ${SELECTOR.IDENTITYPREFIX}-iconsitename\n    `)\n    .addClass(SELECTOR.IDENTITYPREFIX + '-' + $(SELECTOR.LOGOORSITENAME).val());\n    Utils.triggerResize();\n}\n\n/**\n * Site logo size handler.\n */\nfunction iconHandler() {\n    let content = '';\n    let body = $(Utils.getDocument()).find('body');\n    let icon = $(SELECTOR.ICON).val();\n    $(body).find('.navbar-brand-logo i').removeClass().addClass(\"fa fa-\" + icon);\n\n    // Tablet.\n    let fontSizeTab = $(SELECTOR.FONTSIZETABLET).val();\n    let fontSize = $(SELECTOR.FONTSIZE).val();\n    content += `\\n\n        .navbar .navbar-brand-logo {\n            font-size: ${fontSize}rem !important;\n        }\n    `;\n\n    if (fontSizeTab != '') {\n        content += `\\n\n            @media screen and (max-width: ${Utils.deviceWidth.md}px) {\n                .navbar .navbar-brand-logo {\n                    font-size: ${fontSizeTab}rem !important;\n                }\n            }\n        `;\n    }\n    Utils.putStyle(SELECTOR.BASE, content);\n    Utils.triggerResize();\n}\n\n/**\n * Handle header icon color settings.\n */\nfunction iconColorHandler() {\n    let color = $(SELECTOR.SITENAMECOLOR).spectrum('get').toString();\n    let bgColor = $(SELECTOR.LOGOBGCOLOR).spectrum('get').toString();\n    let content = `.navbar .navbar-brand-logo,\n                   .drawer.drawer-left#theme_remui-drawers-primary .drawerheader .navbar-brand .navbar-brand-logo{\n        color: ${color};\n        background-color: ${bgColor};\n    }\n    .navbar .navbar-brand,\n    .drawer.drawer-left#theme_remui-drawers-primary .drawerheader .navbar-brand{\n        background-color: ${bgColor};\n    }`;\n    Utils.putStyle(SELECTOR.COLORCSS, content);\n}\n\n/**\n * Apply settings.\n */\nfunction apply() {\n    logoSelectorHandler();\n    iconHandler();\n    iconColorHandler();\n}\n\n/**\n * Initialize evetns.\n */\nfunction init() {\n    // Logo mini listener.\n    Utils.fileObserver($(SELECTOR.LOGO).siblings('.filemanager')[0], logoSelectorHandler);\n\n    // Logo listener.\n    Utils.fileObserver($(SELECTOR.LOGOMINI).siblings('.filemanager')[0], logoSelectorHandler);\n\n    // Logo or sitename chooser listener.\n    $(SELECTOR.LOGOORSITENAME).on('change', logoSelectorHandler);\n\n    // Site icon listener.\n    // Font size listener.\n    $(`\n        ${SELECTOR.ICON},\n        ${SELECTOR.FONTSIZE},\n        ${SELECTOR.FONTSIZETABLET}\n    `).on('input', iconHandler);\n\n    // Handle icon color.\n    $(`${SELECTOR.SITENAMECOLOR}, ${SELECTOR.LOGOBGCOLOR}`).on('color.changed', iconColorHandler);\n}\n\nexport default {\n    init,\n    apply\n};\n"],"names":["SELECTOR","SHOWLOGO","USEHEADER","CONSTANTS","useForFooter","is","logoSelectorHandler","itemid","siteicon","content","sitename","iframeDocument","Utils","getDocument","closest","addClass","val","removeClass","localStorage","getItem","getFileURL","done","response","M","cfg","wwwroot","find","empty","append","html","attr","triggerResize","iconHandler","body","icon","fontSizeTab","fontSize","deviceWidth","md","putStyle","iconColorHandler","color","spectrum","toString","bgColor","init","fileObserver","siblings","on","apply"],"mappings":"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"}